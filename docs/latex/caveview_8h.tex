\hypertarget{caveview_8h}{}\doxysection{deps/stb/tests/caveview/caveview.h File Reference}
\label{caveview_8h}\index{deps/stb/tests/caveview/caveview.h@{deps/stb/tests/caveview/caveview.h}}
{\ttfamily \#include \char`\"{}stb.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}stb\+\_\+voxel\+\_\+render.\+h\char`\"{}}\newline
{\ttfamily \#include \char`\"{}cave\+\_\+parse.\+h\char`\"{}}\newline
\doxysubsection*{Data Structures}
\begin{DoxyCompactItemize}
\item 
struct \mbox{\hyperlink{structraw__mesh}{raw\+\_\+mesh}}
\end{DoxyCompactItemize}
\doxysubsection*{Macros}
\begin{DoxyCompactItemize}
\item 
\#define \mbox{\hyperlink{caveview_8h_a2a1d7bfce7a2a92571115ed3acfb6a19}{B\+U\+I\+L\+D\+\_\+\+Q\+U\+A\+D\+\_\+\+M\+AX}}~400000
\item 
\#define \mbox{\hyperlink{caveview_8h_afa950acf77b651e25839f9fffcc15e3a}{B\+U\+I\+L\+D\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+S\+I\+ZE}}~(4$\ast$4$\ast$\mbox{\hyperlink{caveview_8h_a2a1d7bfce7a2a92571115ed3acfb6a19}{B\+U\+I\+L\+D\+\_\+\+Q\+U\+A\+D\+\_\+\+M\+AX}})
\item 
\#define \mbox{\hyperlink{caveview_8h_a4d65dca8ffc1cd92783b26732044ba59}{F\+A\+C\+E\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+S\+I\+ZE}}~(  4$\ast$\mbox{\hyperlink{caveview_8h_a2a1d7bfce7a2a92571115ed3acfb6a19}{B\+U\+I\+L\+D\+\_\+\+Q\+U\+A\+D\+\_\+\+M\+AX}})
\end{DoxyCompactItemize}
\doxysubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
\mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} \mbox{\hyperlink{caveview_8h_a24f0dbbfdca90a74902964396c137bac}{mesh\+\_\+init}} (\mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}})
\item 
\mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} \mbox{\hyperlink{caveview_8h_a19d602180d3af1e1e3969518075548cc}{render\+\_\+init}} (\mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}})
\item 
\mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} \mbox{\hyperlink{caveview_8h_a5a106573dea6ac6f71be5e80fb56eefc}{world\+\_\+init}} (\mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}})
\item 
\mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} \mbox{\hyperlink{caveview_8h_aefd62d461236c6e9ced738eac9d8042c}{ods}} (char $\ast$fmt,...)
\item 
\mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} \mbox{\hyperlink{caveview_8h_af74c70130c88949f4d2bac551594d41f}{reset\+\_\+cache\+\_\+size}} (int \mbox{\hyperlink{glad_8h_a3d1e3edfcf61ca2d831883e1afbad89e}{size}})
\item 
\mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} \mbox{\hyperlink{caveview_8h_a2a4f9ffe000359ba183865da3f860ab5}{render\+\_\+caves}} (float pos\mbox{[}3\mbox{]})
\item 
\mbox{\hyperlink{structfast__chunk}{fast\+\_\+chunk}} $\ast$ \mbox{\hyperlink{caveview_8h_a7c54b9b85359841f7dbe539558bc5aa5}{get\+\_\+converted\+\_\+fastchunk}} (int chunk\+\_\+x, int chunk\+\_\+y)
\item 
\mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} \mbox{\hyperlink{caveview_8h_ab4e47a2bc64f10cabe87c675e9b2bcc5}{build\+\_\+chunk}} (int chunk\+\_\+x, int chunk\+\_\+y, \mbox{\hyperlink{structfast__chunk}{fast\+\_\+chunk}} $\ast$fc\+\_\+table\mbox{[}4\mbox{]}\mbox{[}4\mbox{]}, \mbox{\hyperlink{structraw__mesh}{raw\+\_\+mesh}} $\ast$rm)
\item 
\mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} \mbox{\hyperlink{caveview_8h_a65286ae93fc1fc5e6e88af8d2f02a731}{deref\+\_\+fastchunk}} (\mbox{\hyperlink{structfast__chunk}{fast\+\_\+chunk}} $\ast$fc)
\end{DoxyCompactItemize}


\doxysubsection{Macro Definition Documentation}
\mbox{\Hypertarget{caveview_8h_afa950acf77b651e25839f9fffcc15e3a}\label{caveview_8h_afa950acf77b651e25839f9fffcc15e3a}} 
\index{caveview.h@{caveview.h}!BUILD\_BUFFER\_SIZE@{BUILD\_BUFFER\_SIZE}}
\index{BUILD\_BUFFER\_SIZE@{BUILD\_BUFFER\_SIZE}!caveview.h@{caveview.h}}
\doxysubsubsection{\texorpdfstring{BUILD\_BUFFER\_SIZE}{BUILD\_BUFFER\_SIZE}}
{\footnotesize\ttfamily \#define B\+U\+I\+L\+D\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+S\+I\+ZE~(4$\ast$4$\ast$\mbox{\hyperlink{caveview_8h_a2a1d7bfce7a2a92571115ed3acfb6a19}{B\+U\+I\+L\+D\+\_\+\+Q\+U\+A\+D\+\_\+\+M\+AX}})}



Definition at line 29 of file caveview.\+h.

\mbox{\Hypertarget{caveview_8h_a2a1d7bfce7a2a92571115ed3acfb6a19}\label{caveview_8h_a2a1d7bfce7a2a92571115ed3acfb6a19}} 
\index{caveview.h@{caveview.h}!BUILD\_QUAD\_MAX@{BUILD\_QUAD\_MAX}}
\index{BUILD\_QUAD\_MAX@{BUILD\_QUAD\_MAX}!caveview.h@{caveview.h}}
\doxysubsubsection{\texorpdfstring{BUILD\_QUAD\_MAX}{BUILD\_QUAD\_MAX}}
{\footnotesize\ttfamily \#define B\+U\+I\+L\+D\+\_\+\+Q\+U\+A\+D\+\_\+\+M\+AX~400000}



Definition at line 28 of file caveview.\+h.

\mbox{\Hypertarget{caveview_8h_a4d65dca8ffc1cd92783b26732044ba59}\label{caveview_8h_a4d65dca8ffc1cd92783b26732044ba59}} 
\index{caveview.h@{caveview.h}!FACE\_BUFFER\_SIZE@{FACE\_BUFFER\_SIZE}}
\index{FACE\_BUFFER\_SIZE@{FACE\_BUFFER\_SIZE}!caveview.h@{caveview.h}}
\doxysubsubsection{\texorpdfstring{FACE\_BUFFER\_SIZE}{FACE\_BUFFER\_SIZE}}
{\footnotesize\ttfamily \#define F\+A\+C\+E\+\_\+\+B\+U\+F\+F\+E\+R\+\_\+\+S\+I\+ZE~(  4$\ast$\mbox{\hyperlink{caveview_8h_a2a1d7bfce7a2a92571115ed3acfb6a19}{B\+U\+I\+L\+D\+\_\+\+Q\+U\+A\+D\+\_\+\+M\+AX}})}



Definition at line 30 of file caveview.\+h.



\doxysubsection{Function Documentation}
\mbox{\Hypertarget{caveview_8h_ab4e47a2bc64f10cabe87c675e9b2bcc5}\label{caveview_8h_ab4e47a2bc64f10cabe87c675e9b2bcc5}} 
\index{caveview.h@{caveview.h}!build\_chunk@{build\_chunk}}
\index{build\_chunk@{build\_chunk}!caveview.h@{caveview.h}}
\doxysubsubsection{\texorpdfstring{build\_chunk()}{build\_chunk()}}
{\footnotesize\ttfamily \mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} build\+\_\+chunk (\begin{DoxyParamCaption}\item[{int}]{chunk\+\_\+x,  }\item[{int}]{chunk\+\_\+y,  }\item[{\mbox{\hyperlink{structfast__chunk}{fast\+\_\+chunk}} $\ast$}]{fc\+\_\+table\mbox{[}4\mbox{]}\mbox{[}4\mbox{]},  }\item[{\mbox{\hyperlink{structraw__mesh}{raw\+\_\+mesh}} $\ast$}]{rm }\end{DoxyParamCaption})}



Definition at line 602 of file cave\+\_\+mesher.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{603 \{}
\DoxyCodeLine{604    \textcolor{keywordtype}{int} \mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}},\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}},\mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}};}
\DoxyCodeLine{605    \mbox{\hyperlink{structstbvox__input__description}{stbvox\_input\_description}} *map;}
\DoxyCodeLine{606 }
\DoxyCodeLine{607 \textcolor{preprocessor}{   \#ifdef VHEIGHT\_TEST}}
\DoxyCodeLine{608    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} vheight[34][34][18];}
\DoxyCodeLine{609 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{610 }
\DoxyCodeLine{611 \textcolor{preprocessor}{   \#ifndef STBVOX\_CONFIG\_DISABLE\_TEX2}}
\DoxyCodeLine{612    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} tex2\_choice[34][34][18];}
\DoxyCodeLine{613 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{614 }
\DoxyCodeLine{615    assert((chunk\_x \& 1) == 0);}
\DoxyCodeLine{616    assert((chunk\_y \& 1) == 0);}
\DoxyCodeLine{617 }
\DoxyCodeLine{618    rm-\/>\mbox{\hyperlink{structraw__mesh_a2d8a1b1dea7e8a743e0f5aafb434befb}{cx}} = chunk\_x;}
\DoxyCodeLine{619    rm-\/>\mbox{\hyperlink{structraw__mesh_a9098748aa135ddeeb362867175cc6751}{cy}} = chunk\_y;}
\DoxyCodeLine{620 }
\DoxyCodeLine{621    \mbox{\hyperlink{stb__voxel__render_8h_a089559775ad9ffc7671d147ef40f6509}{stbvox\_set\_input\_stride}}(\&rm-\/>\mbox{\hyperlink{structraw__mesh_a39eed89ae7fec0a09b73e75946c57640}{mm}}, 34*18, 18);}
\DoxyCodeLine{622 }
\DoxyCodeLine{623    assert(rm-\/>\mbox{\hyperlink{structraw__mesh_a39eed89ae7fec0a09b73e75946c57640}{mm}}.\mbox{\hyperlink{structstbvox__mesh__maker_ae83f21625eef0fb8db4d55900b1e8d74}{input}}.\mbox{\hyperlink{structstbvox__input__description_a18e00a30f954f1ab1a1a5ad69e35b8ee}{geometry}} == \mbox{\hyperlink{include_2vally_2config_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{624 }
\DoxyCodeLine{625    map = \mbox{\hyperlink{stb__voxel__render_8h_adadf81990fab203a9b48c738922899e1}{stbvox\_get\_input\_description}}(\&rm-\/>\mbox{\hyperlink{structraw__mesh_a39eed89ae7fec0a09b73e75946c57640}{mm}});}
\DoxyCodeLine{626    map-\/>\mbox{\hyperlink{structstbvox__input__description_a85cf8f5f29e98cd445900b131a9a8a8d}{block\_tex1\_face}} = \mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}};}
\DoxyCodeLine{627    map-\/>\mbox{\hyperlink{structstbvox__input__description_a4cba1da418a53a010b75d6cee593aece}{block\_color\_face}} = \mbox{\hyperlink{cave__mesher_8c_a33fdd49440ce0309319d973be49dfd0a}{minecraft\_color\_for\_blocktype}};}
\DoxyCodeLine{628    map-\/>\mbox{\hyperlink{structstbvox__input__description_acdcebc8d321327f365bbd3a3468f7f2d}{block\_geometry}} = \mbox{\hyperlink{cave__mesher_8c_ae01a977fd1f7c889f186baee1076b732}{minecraft\_geom\_for\_blocktype}};}
\DoxyCodeLine{629 }
\DoxyCodeLine{630    \mbox{\hyperlink{stb__voxel__render_8h_a34226517e08ca1da34b39d34a5c31031}{stbvox\_reset\_buffers}}(\&rm-\/>\mbox{\hyperlink{structraw__mesh_a39eed89ae7fec0a09b73e75946c57640}{mm}});}
\DoxyCodeLine{631    \mbox{\hyperlink{stb__voxel__render_8h_a3b24ab8855010267a0e93541d1673fb9}{stbvox\_set\_buffer}}(\&rm-\/>\mbox{\hyperlink{structraw__mesh_a39eed89ae7fec0a09b73e75946c57640}{mm}}, 0, 0, rm-\/>\mbox{\hyperlink{structraw__mesh_aeea914666948a38adf71765721139455}{build\_buffer}}, \mbox{\hyperlink{caveview_8h_afa950acf77b651e25839f9fffcc15e3a}{BUILD\_BUFFER\_SIZE}});}
\DoxyCodeLine{632    \mbox{\hyperlink{stb__voxel__render_8h_a3b24ab8855010267a0e93541d1673fb9}{stbvox\_set\_buffer}}(\&rm-\/>\mbox{\hyperlink{structraw__mesh_a39eed89ae7fec0a09b73e75946c57640}{mm}}, 0, 1, rm-\/>\mbox{\hyperlink{structraw__mesh_a5e8e2e14af2f1cfa02d66f7a2fcb0a81}{face\_buffer}} , \mbox{\hyperlink{caveview_8h_a4d65dca8ffc1cd92783b26732044ba59}{FACE\_BUFFER\_SIZE}});}
\DoxyCodeLine{633 }
\DoxyCodeLine{634    map-\/>\mbox{\hyperlink{structstbvox__input__description_a68f6d2ab5ba77e7e80021d60a2af7019}{blocktype}} = \&rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}[1][1][1]; \textcolor{comment}{// this is (0,0,0), but we need to be able to query off the edges}}
\DoxyCodeLine{635    map-\/>\mbox{\hyperlink{structstbvox__input__description_a6b64e4cf0061bfe6dbae7981a002ab77}{lighting}} = \&rm-\/>\mbox{\hyperlink{structraw__mesh_afb37f5f58e50feb7d873c2ee28dcf00c}{sv\_lighting}}[1][1][1];}
\DoxyCodeLine{636 }
\DoxyCodeLine{637    \textcolor{comment}{// fill in the top two rows of the buffer}}
\DoxyCodeLine{638    \textcolor{keywordflow}{for} (\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}=0; \mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}} < 34; ++\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}) \{}
\DoxyCodeLine{639       \textcolor{keywordflow}{for} (\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}=0; \mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}} < 34; ++\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}) \{}
\DoxyCodeLine{640          rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][16] = 0;}
\DoxyCodeLine{641          rm-\/>\mbox{\hyperlink{structraw__mesh_afb37f5f58e50feb7d873c2ee28dcf00c}{sv\_lighting}} [\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][16] = 255;}
\DoxyCodeLine{642          rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][17] = 0;}
\DoxyCodeLine{643          rm-\/>\mbox{\hyperlink{structraw__mesh_afb37f5f58e50feb7d873c2ee28dcf00c}{sv\_lighting}} [\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][17] = 255;}
\DoxyCodeLine{644       \}}
\DoxyCodeLine{645    \}}
\DoxyCodeLine{646 }
\DoxyCodeLine{647 \textcolor{preprocessor}{   \#ifndef STBVOX\_CONFIG\_DISABLE\_TEX2}}
\DoxyCodeLine{648    \textcolor{keywordflow}{for} (\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}=0; \mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}} < 34; ++\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}) \{}
\DoxyCodeLine{649       \textcolor{keywordflow}{for} (\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}=0; \mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}} < 34; ++\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}) \{}
\DoxyCodeLine{650          \textcolor{keywordtype}{int} px = chunk\_x*16 + \mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}} -\/ 1;}
\DoxyCodeLine{651          \textcolor{keywordtype}{int} py = chunk\_y*16 + \mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}} -\/ 1;}
\DoxyCodeLine{652          \textcolor{keywordtype}{float} dist = (float) sqrt(px*px + py*py);}
\DoxyCodeLine{653          \textcolor{keywordtype}{float} \mbox{\hyperlink{glext_8h_a4ed25fb4dc5bf1a768a78d2e2f0ca003}{s1}} = (float) sin(dist / 16), s2, s3;}
\DoxyCodeLine{654          dist = (float) sqrt((px-\/80)*(px-\/80) + (py-\/50)*(py-\/50));}
\DoxyCodeLine{655          s2 = (float) sin(dist / 11);}
\DoxyCodeLine{656          \textcolor{keywordflow}{for} (\mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}}=0; \mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}} < 18; ++\mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}}) \{}
\DoxyCodeLine{657             s3 = (float) sin(\mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}} * 3.141592 / 8);}
\DoxyCodeLine{658 }
\DoxyCodeLine{659             s3 = \mbox{\hyperlink{glext_8h_a4ed25fb4dc5bf1a768a78d2e2f0ca003}{s1}}*s2*s3;}
\DoxyCodeLine{660             tex2\_choice[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][\mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}}] = 63 \& (int) \mbox{\hyperlink{stb_8h_ab2a4b1beb0e146a2cd0fed985d185909}{stb\_linear\_remap}}(s3,-\/1,1, -\/20,83);}
\DoxyCodeLine{661          \}}
\DoxyCodeLine{662       \}}
\DoxyCodeLine{663    \}}
\DoxyCodeLine{664 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{665 }
\DoxyCodeLine{666    \textcolor{keywordflow}{for} (\mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}}=256-\/16; \mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}} >= \mbox{\hyperlink{cave__mesher_8c_af205db34cd0a183e5e3481c4f8baa716}{SKIP\_TERRAIN}}; \mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}} -\/= 16)}
\DoxyCodeLine{667    \{}
\DoxyCodeLine{668       \textcolor{keywordtype}{int} z0 = \mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}};}
\DoxyCodeLine{669       \textcolor{keywordtype}{int} z1 = \mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}}+16;}
\DoxyCodeLine{670       \textcolor{keywordflow}{if} (z1 == 256) z1 = 255;}
\DoxyCodeLine{671 }
\DoxyCodeLine{672       \mbox{\hyperlink{cave__mesher_8c_a72869edd94d6159ab80497d6fcf71071}{make\_map\_segment\_for\_superchunk\_preconvert}}(chunk\_x, chunk\_y, \mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}} >> 4, fc\_table, rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}, rm-\/>\mbox{\hyperlink{structraw__mesh_afb37f5f58e50feb7d873c2ee28dcf00c}{sv\_lighting}});}
\DoxyCodeLine{673 }
\DoxyCodeLine{674       map-\/>\mbox{\hyperlink{structstbvox__input__description_a68f6d2ab5ba77e7e80021d60a2af7019}{blocktype}} = \&rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}[1][1][1-\/\mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}}]; \textcolor{comment}{// specify location of 0,0,0 so that accessing z0..z1 gets right data}}
\DoxyCodeLine{675       map-\/>\mbox{\hyperlink{structstbvox__input__description_a6b64e4cf0061bfe6dbae7981a002ab77}{lighting}} = \&rm-\/>\mbox{\hyperlink{structraw__mesh_afb37f5f58e50feb7d873c2ee28dcf00c}{sv\_lighting}}[1][1][1-\/\mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}}];}
\DoxyCodeLine{676 \textcolor{preprocessor}{      \#ifndef STBVOX\_CONFIG\_DISABLE\_TEX2}}
\DoxyCodeLine{677       map-\/>\mbox{\hyperlink{structstbvox__input__description_a21f1647c23699b973eecb6b2ea50e721}{tex2}} = \&tex2\_choice[1][1][1-\/\mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}}];}
\DoxyCodeLine{678 \textcolor{preprocessor}{      \#endif}}
\DoxyCodeLine{679 }
\DoxyCodeLine{680 \textcolor{preprocessor}{      \#ifdef VHEIGHT\_TEST}}
\DoxyCodeLine{681       \textcolor{comment}{// hacky test of vheight}}
\DoxyCodeLine{682       \textcolor{keywordflow}{for} (\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}=0; \mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}} < 34; ++\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}) \{}
\DoxyCodeLine{683          \textcolor{keywordflow}{for} (\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}=0; \mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}} < 34; ++\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}) \{}
\DoxyCodeLine{684             \textcolor{keywordtype}{int} \mbox{\hyperlink{glext_8h_a1f2d7f8147412c43ba2303a56f97ee73}{c}};}
\DoxyCodeLine{685             \textcolor{keywordflow}{for} (\mbox{\hyperlink{glext_8h_a1f2d7f8147412c43ba2303a56f97ee73}{c}}=0; \mbox{\hyperlink{glext_8h_a1f2d7f8147412c43ba2303a56f97ee73}{c}} < 17; ++\mbox{\hyperlink{glext_8h_a1f2d7f8147412c43ba2303a56f97ee73}{c}}) \{}
\DoxyCodeLine{686                \textcolor{keywordflow}{if} (rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][\mbox{\hyperlink{glext_8h_a1f2d7f8147412c43ba2303a56f97ee73}{c}}] != 0 \&\& rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][\mbox{\hyperlink{glext_8h_a1f2d7f8147412c43ba2303a56f97ee73}{c}}+1] == 0) \{}
\DoxyCodeLine{687                   \textcolor{comment}{// topmost block}}
\DoxyCodeLine{688                   vheight[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][\mbox{\hyperlink{glext_8h_a1f2d7f8147412c43ba2303a56f97ee73}{c}}] = rand() \& 255;}
\DoxyCodeLine{689                   rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][\mbox{\hyperlink{glext_8h_a1f2d7f8147412c43ba2303a56f97ee73}{c}}] = 168;}
\DoxyCodeLine{690                \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (\mbox{\hyperlink{glext_8h_a1f2d7f8147412c43ba2303a56f97ee73}{c}} > 0 \&\& rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][\mbox{\hyperlink{glext_8h_a1f2d7f8147412c43ba2303a56f97ee73}{c}}] != 0 \&\& rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][\mbox{\hyperlink{glext_8h_a1f2d7f8147412c43ba2303a56f97ee73}{c}}-\/1] == 0) \{}
\DoxyCodeLine{691                   \textcolor{comment}{// bottommost block}}
\DoxyCodeLine{692                   vheight[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][\mbox{\hyperlink{glext_8h_a1f2d7f8147412c43ba2303a56f97ee73}{c}}] = ((rand() \% 3) << 6) + ((rand() \% 3) << 4) + ((rand() \% 3) << 2) + (rand() \% 3);}
\DoxyCodeLine{693                   rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][\mbox{\hyperlink{glext_8h_a1f2d7f8147412c43ba2303a56f97ee73}{c}}] = 169;}
\DoxyCodeLine{694                \}}
\DoxyCodeLine{695             \}}
\DoxyCodeLine{696             vheight[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][\mbox{\hyperlink{glext_8h_a1f2d7f8147412c43ba2303a56f97ee73}{c}}] = \mbox{\hyperlink{stb__voxel__render_8h_a7481d3530d34c5048938868910e259e3}{STBVOX\_MAKE\_VHEIGHT}}(2,2,2,2); \textcolor{comment}{// flat top}}
\DoxyCodeLine{697          \}}
\DoxyCodeLine{698       \}}
\DoxyCodeLine{699       map-\/>\mbox{\hyperlink{structstbvox__input__description_a02de8f98d512dc9cef6094ad7571be05}{vheight}} = \&vheight[1][1][1-\/\mbox{\hyperlink{glad_8h_a1483160fae141afea848a5393c286b2b}{z}}];}
\DoxyCodeLine{700 \textcolor{preprocessor}{      \#endif}}
\DoxyCodeLine{701 }
\DoxyCodeLine{702       \{}
\DoxyCodeLine{703          \mbox{\hyperlink{stb__voxel__render_8h_a63fbb8703cf2c2718e6a0b4a90db00e6}{stbvox\_set\_input\_range}}(\&rm-\/>\mbox{\hyperlink{structraw__mesh_a39eed89ae7fec0a09b73e75946c57640}{mm}}, 0,0,z0, 32,32,z1);}
\DoxyCodeLine{704          \mbox{\hyperlink{stb__voxel__render_8h_aae8b2a3e95db09861fef397aeb7cf10d}{stbvox\_set\_default\_mesh}}(\&rm-\/>\mbox{\hyperlink{structraw__mesh_a39eed89ae7fec0a09b73e75946c57640}{mm}}, 0);}
\DoxyCodeLine{705          \mbox{\hyperlink{stb__voxel__render_8h_ab792b164e02789bce6e2ba96a4b8f935}{stbvox\_make\_mesh}}(\&rm-\/>\mbox{\hyperlink{structraw__mesh_a39eed89ae7fec0a09b73e75946c57640}{mm}});}
\DoxyCodeLine{706       \}}
\DoxyCodeLine{707 }
\DoxyCodeLine{708       \textcolor{comment}{// copy the bottom two rows of data up to the top}}
\DoxyCodeLine{709       \textcolor{keywordflow}{for} (\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}=0; \mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}} < 34; ++\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}) \{}
\DoxyCodeLine{710          \textcolor{keywordflow}{for} (\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}=0; \mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}} < 34; ++\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}) \{}
\DoxyCodeLine{711             rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][16] = rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][0];}
\DoxyCodeLine{712             rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][17] = rm-\/>\mbox{\hyperlink{structraw__mesh_aed4362c13d96da67cf5237df5bed86cc}{sv\_blocktype}}[\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][1];}
\DoxyCodeLine{713             rm-\/>\mbox{\hyperlink{structraw__mesh_afb37f5f58e50feb7d873c2ee28dcf00c}{sv\_lighting}} [\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][16] = rm-\/>\mbox{\hyperlink{structraw__mesh_afb37f5f58e50feb7d873c2ee28dcf00c}{sv\_lighting}} [\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][0];}
\DoxyCodeLine{714             rm-\/>\mbox{\hyperlink{structraw__mesh_afb37f5f58e50feb7d873c2ee28dcf00c}{sv\_lighting}} [\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][17] = rm-\/>\mbox{\hyperlink{structraw__mesh_afb37f5f58e50feb7d873c2ee28dcf00c}{sv\_lighting}} [\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}][\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}][1];}
\DoxyCodeLine{715          \}}
\DoxyCodeLine{716       \}}
\DoxyCodeLine{717    \}}
\DoxyCodeLine{718 }
\DoxyCodeLine{719    \mbox{\hyperlink{stb__voxel__render_8h_a4592b690afe4825bfabdfd9ae29fb35e}{stbvox\_set\_mesh\_coordinates}}(\&rm-\/>\mbox{\hyperlink{structraw__mesh_a39eed89ae7fec0a09b73e75946c57640}{mm}}, chunk\_x*16, chunk\_y*16, 0);}
\DoxyCodeLine{720    \mbox{\hyperlink{stb__voxel__render_8h_a0a8668048f7cca70ef7043261761da90}{stbvox\_get\_transform}}(\&rm-\/>\mbox{\hyperlink{structraw__mesh_a39eed89ae7fec0a09b73e75946c57640}{mm}}, rm-\/>\mbox{\hyperlink{structraw__mesh_a85966417fa9b2b01fa2deb493d59996a}{transform}});}
\DoxyCodeLine{721 }
\DoxyCodeLine{722    \mbox{\hyperlink{stb__voxel__render_8h_a63fbb8703cf2c2718e6a0b4a90db00e6}{stbvox\_set\_input\_range}}(\&rm-\/>\mbox{\hyperlink{structraw__mesh_a39eed89ae7fec0a09b73e75946c57640}{mm}}, 0,0,0, 32,32,255);}
\DoxyCodeLine{723    \mbox{\hyperlink{stb__voxel__render_8h_a0ad8a7764f93c0592671bcf0e246dc6e}{stbvox\_get\_bounds}}(\&rm-\/>\mbox{\hyperlink{structraw__mesh_a39eed89ae7fec0a09b73e75946c57640}{mm}}, rm-\/>\mbox{\hyperlink{structraw__mesh_ad56f04c63fd9fc1263329916029d6222}{bounds}});}
\DoxyCodeLine{724 }
\DoxyCodeLine{725    rm-\/>\mbox{\hyperlink{structraw__mesh_aaa6e0d90284bfa6172577269e7d1d84a}{num\_quads}} = \mbox{\hyperlink{stb__voxel__render_8h_ace18e150b58146e2ec7ecba5ca0517b6}{stbvox\_get\_quad\_count}}(\&rm-\/>\mbox{\hyperlink{structraw__mesh_a39eed89ae7fec0a09b73e75946c57640}{mm}}, 0);}
\DoxyCodeLine{726 \}}

\end{DoxyCode}
\mbox{\Hypertarget{caveview_8h_a65286ae93fc1fc5e6e88af8d2f02a731}\label{caveview_8h_a65286ae93fc1fc5e6e88af8d2f02a731}} 
\index{caveview.h@{caveview.h}!deref\_fastchunk@{deref\_fastchunk}}
\index{deref\_fastchunk@{deref\_fastchunk}!caveview.h@{caveview.h}}
\doxysubsubsection{\texorpdfstring{deref\_fastchunk()}{deref\_fastchunk()}}
{\footnotesize\ttfamily \mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} deref\+\_\+fastchunk (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{structfast__chunk}{fast\+\_\+chunk}} $\ast$}]{fc }\end{DoxyParamCaption})}



Definition at line 510 of file cave\+\_\+mesher.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{511 \{}
\DoxyCodeLine{512    \textcolor{keywordflow}{if} (fc) \{}
\DoxyCodeLine{513       assert(fc-\/>\mbox{\hyperlink{structfast__chunk_a0bcf2001e68fdcf8e5eaf83a7ea83440}{refcount}} > 0);}
\DoxyCodeLine{514       -\/-\/fc-\/>\mbox{\hyperlink{structfast__chunk_a0bcf2001e68fdcf8e5eaf83a7ea83440}{refcount}};}
\DoxyCodeLine{515       \textcolor{keywordflow}{if} (fc-\/>\mbox{\hyperlink{structfast__chunk_a0bcf2001e68fdcf8e5eaf83a7ea83440}{refcount}} == 0) \{}
\DoxyCodeLine{516          \mbox{\hyperlink{stb__leakcheck_8h_a9d4b5df3530d1bc733070a4669ba6ebc}{free}}(fc-\/>\mbox{\hyperlink{structfast__chunk_aea03b39185c1d472a7f61f86529f0863}{pointer\_to\_free}});}
\DoxyCodeLine{517          \mbox{\hyperlink{stb__leakcheck_8h_a9d4b5df3530d1bc733070a4669ba6ebc}{free}}(fc);}
\DoxyCodeLine{518       \}}
\DoxyCodeLine{519    \}}
\DoxyCodeLine{520 \}}

\end{DoxyCode}
\mbox{\Hypertarget{caveview_8h_a7c54b9b85359841f7dbe539558bc5aa5}\label{caveview_8h_a7c54b9b85359841f7dbe539558bc5aa5}} 
\index{caveview.h@{caveview.h}!get\_converted\_fastchunk@{get\_converted\_fastchunk}}
\index{get\_converted\_fastchunk@{get\_converted\_fastchunk}!caveview.h@{caveview.h}}
\doxysubsubsection{\texorpdfstring{get\_converted\_fastchunk()}{get\_converted\_fastchunk()}}
{\footnotesize\ttfamily \mbox{\hyperlink{structfast__chunk}{fast\+\_\+chunk}}$\ast$ get\+\_\+converted\+\_\+fastchunk (\begin{DoxyParamCaption}\item[{int}]{chunk\+\_\+x,  }\item[{int}]{chunk\+\_\+y }\end{DoxyParamCaption})}



Definition at line 534 of file cave\+\_\+mesher.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{535 \{}
\DoxyCodeLine{536    \textcolor{keywordtype}{int} slot\_x = (chunk\_x \& (\mbox{\hyperlink{cave__mesher_8c_adc2cfac3a357c5424aafa9d351a2e6ea}{cache\_size}}-\/1));}
\DoxyCodeLine{537    \textcolor{keywordtype}{int} slot\_y = (chunk\_y \& (\mbox{\hyperlink{cave__mesher_8c_adc2cfac3a357c5424aafa9d351a2e6ea}{cache\_size}}-\/1));}
\DoxyCodeLine{538    \mbox{\hyperlink{structfast__chunk}{fast\_chunk}} *fc;}
\DoxyCodeLine{539    \mbox{\hyperlink{structcached__converted__chunk}{cached\_converted\_chunk}} *ccc;}
\DoxyCodeLine{540    SDL\_LockMutex(\mbox{\hyperlink{cave__mesher_8c_a784ba0617dbc4eec455188b9671295aa}{chunk\_cache\_mutex}});}
\DoxyCodeLine{541    ccc = \&\mbox{\hyperlink{cave__mesher_8c_ab799c6e56a65a1a9a2c089c9d4b81de9}{chunk\_cache}}[slot\_y][slot\_x];}
\DoxyCodeLine{542    \textcolor{keywordflow}{if} (ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_a890fc62a8689a97e24ffd59097770836}{valid}}) \{}
\DoxyCodeLine{543       \textcolor{keywordflow}{if} (ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_a720a08b6d6b18cf740d807dd119c52c0}{chunk\_x}} == chunk\_x \&\& ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_a5a71274f9dc7a89cd3e962a719e0ac7f}{chunk\_y}} == chunk\_y) \{}
\DoxyCodeLine{544          \mbox{\hyperlink{structfast__chunk}{fast\_chunk}} *fc = ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_ad891f426a0caf16bf5a9a54439beeade}{fc}};}
\DoxyCodeLine{545          \textcolor{keywordflow}{if} (fc)}
\DoxyCodeLine{546             ++fc-\/>\mbox{\hyperlink{structfast__chunk_a0bcf2001e68fdcf8e5eaf83a7ea83440}{refcount}};}
\DoxyCodeLine{547          SDL\_UnlockMutex(\mbox{\hyperlink{cave__mesher_8c_a784ba0617dbc4eec455188b9671295aa}{chunk\_cache\_mutex}});}
\DoxyCodeLine{548          \textcolor{keywordflow}{return} fc;}
\DoxyCodeLine{549       \}}
\DoxyCodeLine{550       \textcolor{keywordflow}{if} (ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_ad891f426a0caf16bf5a9a54439beeade}{fc}}) \{}
\DoxyCodeLine{551          \mbox{\hyperlink{cave__mesher_8c_a65286ae93fc1fc5e6e88af8d2f02a731}{deref\_fastchunk}}(ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_ad891f426a0caf16bf5a9a54439beeade}{fc}});}
\DoxyCodeLine{552          ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_ad891f426a0caf16bf5a9a54439beeade}{fc}} = \mbox{\hyperlink{include_2vally_2config_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{553          ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_a890fc62a8689a97e24ffd59097770836}{valid}} = 0;}
\DoxyCodeLine{554       \}}
\DoxyCodeLine{555    \}}
\DoxyCodeLine{556    SDL\_UnlockMutex(\mbox{\hyperlink{cave__mesher_8c_a784ba0617dbc4eec455188b9671295aa}{chunk\_cache\_mutex}});}
\DoxyCodeLine{557 }
\DoxyCodeLine{558    fc = \mbox{\hyperlink{cave__parse_8c_ac3885b139871d53a3d39cca5380075c9}{get\_decoded\_fastchunk\_uncached}}(chunk\_x, -\/chunk\_y);}
\DoxyCodeLine{559    \textcolor{keywordflow}{if} (fc)}
\DoxyCodeLine{560       \mbox{\hyperlink{cave__mesher_8c_a147e37fcae806febbdaac22c776d5685}{convert\_fastchunk\_inplace}}(fc);}
\DoxyCodeLine{561 }
\DoxyCodeLine{562    SDL\_LockMutex(\mbox{\hyperlink{cave__mesher_8c_a784ba0617dbc4eec455188b9671295aa}{chunk\_cache\_mutex}});}
\DoxyCodeLine{563    \textcolor{comment}{// another thread might have updated it, so before we overwrite it...}}
\DoxyCodeLine{564    \textcolor{keywordflow}{if} (ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_ad891f426a0caf16bf5a9a54439beeade}{fc}}) \{}
\DoxyCodeLine{565       \mbox{\hyperlink{cave__mesher_8c_a65286ae93fc1fc5e6e88af8d2f02a731}{deref\_fastchunk}}(ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_ad891f426a0caf16bf5a9a54439beeade}{fc}});}
\DoxyCodeLine{566       ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_ad891f426a0caf16bf5a9a54439beeade}{fc}} = \mbox{\hyperlink{include_2vally_2config_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{567    \}}
\DoxyCodeLine{568 }
\DoxyCodeLine{569    \textcolor{keywordflow}{if} (fc)}
\DoxyCodeLine{570       fc-\/>\mbox{\hyperlink{structfast__chunk_a0bcf2001e68fdcf8e5eaf83a7ea83440}{refcount}} = 1; \textcolor{comment}{// 1 in the cache}}
\DoxyCodeLine{571 }
\DoxyCodeLine{572    ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_a720a08b6d6b18cf740d807dd119c52c0}{chunk\_x}} = chunk\_x;}
\DoxyCodeLine{573    ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_a5a71274f9dc7a89cd3e962a719e0ac7f}{chunk\_y}} = chunk\_y;}
\DoxyCodeLine{574    ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_a890fc62a8689a97e24ffd59097770836}{valid}} = 1;}
\DoxyCodeLine{575    \textcolor{keywordflow}{if} (fc)}
\DoxyCodeLine{576       ++fc-\/>\mbox{\hyperlink{structfast__chunk_a0bcf2001e68fdcf8e5eaf83a7ea83440}{refcount}};}
\DoxyCodeLine{577    ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_ad891f426a0caf16bf5a9a54439beeade}{fc}} = fc;}
\DoxyCodeLine{578    SDL\_UnlockMutex(\mbox{\hyperlink{cave__mesher_8c_a784ba0617dbc4eec455188b9671295aa}{chunk\_cache\_mutex}});}
\DoxyCodeLine{579    \textcolor{keywordflow}{return} fc;}
\DoxyCodeLine{580 \}}

\end{DoxyCode}
\mbox{\Hypertarget{caveview_8h_a24f0dbbfdca90a74902964396c137bac}\label{caveview_8h_a24f0dbbfdca90a74902964396c137bac}} 
\index{caveview.h@{caveview.h}!mesh\_init@{mesh\_init}}
\index{mesh\_init@{mesh\_init}!caveview.h@{caveview.h}}
\doxysubsubsection{\texorpdfstring{mesh\_init()}{mesh\_init()}}
{\footnotesize\ttfamily \mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} mesh\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}}}]{ }\end{DoxyParamCaption})}



Definition at line 803 of file cave\+\_\+mesher.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{804 \{}
\DoxyCodeLine{805    \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{806 }
\DoxyCodeLine{807    \mbox{\hyperlink{cave__mesher_8c_a784ba0617dbc4eec455188b9671295aa}{chunk\_cache\_mutex}} = SDL\_CreateMutex();}
\DoxyCodeLine{808    \mbox{\hyperlink{cave__mesher_8c_a9105640f64bd2fca823fa679f99fb62b}{chunk\_get\_mutex}}   = SDL\_CreateMutex();}
\DoxyCodeLine{809 }
\DoxyCodeLine{810    \textcolor{keywordflow}{for} (i=0; i < 256; ++i) \{}
\DoxyCodeLine{811       memcpy(\mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[i], \mbox{\hyperlink{cave__mesher_8c_a17dd80d3766327026eae4547eae231fd}{minecraft\_info}}[i]+1, 6);}
\DoxyCodeLine{812       \mbox{\hyperlink{cave__mesher_8c_af38282980cc171915d4acfe5f3e03c90}{effective\_blocktype}}[i] = (\mbox{\hyperlink{cave__mesher_8c_a17dd80d3766327026eae4547eae231fd}{minecraft\_info}}[i][0] == \mbox{\hyperlink{cave__mesher_8c_aa57e16cd48de3b9a989056ff8df26f84a8e25f3fef8ddfd9ae47971d91958d83b}{C\_empty}} ? 0 : i);}
\DoxyCodeLine{813       \mbox{\hyperlink{cave__mesher_8c_ae01a977fd1f7c889f186baee1076b732}{minecraft\_geom\_for\_blocktype}}[i] = \mbox{\hyperlink{cave__mesher_8c_adbdd9089890d950d54cd125d4464eab7}{geom\_map}}[\mbox{\hyperlink{cave__mesher_8c_a17dd80d3766327026eae4547eae231fd}{minecraft\_info}}[i][0]];}
\DoxyCodeLine{814    \}}
\DoxyCodeLine{815    \textcolor{comment}{//effective\_blocktype[50] = 0; // delete torches}}
\DoxyCodeLine{816 }
\DoxyCodeLine{817    \textcolor{keywordflow}{for} (i=0; i < 6*256; ++i) \{}
\DoxyCodeLine{818       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[0][i] == 40)}
\DoxyCodeLine{819          \mbox{\hyperlink{cave__mesher_8c_a33fdd49440ce0309319d973be49dfd0a}{minecraft\_color\_for\_blocktype}}[0][i] = 38 | 64; \textcolor{comment}{// apply to tex1}}
\DoxyCodeLine{820       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[0][i] == 39)}
\DoxyCodeLine{821          \mbox{\hyperlink{cave__mesher_8c_a33fdd49440ce0309319d973be49dfd0a}{minecraft\_color\_for\_blocktype}}[0][i] = 39 | 64; \textcolor{comment}{// apply to tex1}}
\DoxyCodeLine{822       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[0][i] == 105)}
\DoxyCodeLine{823          \mbox{\hyperlink{cave__mesher_8c_a33fdd49440ce0309319d973be49dfd0a}{minecraft\_color\_for\_blocktype}}[0][i] = 63; \textcolor{comment}{// emissive}}
\DoxyCodeLine{824       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[0][i] == 212)}
\DoxyCodeLine{825          \mbox{\hyperlink{cave__mesher_8c_a33fdd49440ce0309319d973be49dfd0a}{minecraft\_color\_for\_blocktype}}[0][i] = 63; \textcolor{comment}{// emissive}}
\DoxyCodeLine{826       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[0][i] == 80)}
\DoxyCodeLine{827          \mbox{\hyperlink{cave__mesher_8c_a33fdd49440ce0309319d973be49dfd0a}{minecraft\_color\_for\_blocktype}}[0][i] = 63; \textcolor{comment}{// emissive}}
\DoxyCodeLine{828    \}}
\DoxyCodeLine{829 }
\DoxyCodeLine{830    \textcolor{keywordflow}{for} (i=0; i < 6; ++i) \{}
\DoxyCodeLine{831       \mbox{\hyperlink{cave__mesher_8c_a33fdd49440ce0309319d973be49dfd0a}{minecraft\_color\_for\_blocktype}}[172][i] = 47 | 64; \textcolor{comment}{// apply to tex1}}
\DoxyCodeLine{832       \mbox{\hyperlink{cave__mesher_8c_a33fdd49440ce0309319d973be49dfd0a}{minecraft\_color\_for\_blocktype}}[178][i] = 47 | 64; \textcolor{comment}{// apply to tex1}}
\DoxyCodeLine{833       \mbox{\hyperlink{cave__mesher_8c_a33fdd49440ce0309319d973be49dfd0a}{minecraft\_color\_for\_blocktype}}[18][i] = 39 | 64; \textcolor{comment}{// green}}
\DoxyCodeLine{834       \mbox{\hyperlink{cave__mesher_8c_a33fdd49440ce0309319d973be49dfd0a}{minecraft\_color\_for\_blocktype}}[161][i] = 37 | 64; \textcolor{comment}{// green}}
\DoxyCodeLine{835       \mbox{\hyperlink{cave__mesher_8c_a33fdd49440ce0309319d973be49dfd0a}{minecraft\_color\_for\_blocktype}}[10][i] = 63; \textcolor{comment}{// emissive lava}}
\DoxyCodeLine{836       \mbox{\hyperlink{cave__mesher_8c_a33fdd49440ce0309319d973be49dfd0a}{minecraft\_color\_for\_blocktype}}[11][i] = 63; \textcolor{comment}{// emissive}}
\DoxyCodeLine{837       \textcolor{comment}{//minecraft\_color\_for\_blocktype[56][i] = 63; // emissive diamond}}
\DoxyCodeLine{838       \mbox{\hyperlink{cave__mesher_8c_a33fdd49440ce0309319d973be49dfd0a}{minecraft\_color\_for\_blocktype}}[48][i] = 63; \textcolor{comment}{// emissive dungeon}}
\DoxyCodeLine{839    \}}
\DoxyCodeLine{840 }
\DoxyCodeLine{841 \textcolor{preprocessor}{   \#ifdef VHEIGHT\_TEST}}
\DoxyCodeLine{842    \mbox{\hyperlink{cave__mesher_8c_af38282980cc171915d4acfe5f3e03c90}{effective\_blocktype}}[168] = 168;}
\DoxyCodeLine{843    \mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[168][0] = 1;}
\DoxyCodeLine{844    \mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[168][1] = 1;}
\DoxyCodeLine{845    \mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[168][2] = 1;}
\DoxyCodeLine{846    \mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[168][3] = 1;}
\DoxyCodeLine{847    \mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[168][4] = 1;}
\DoxyCodeLine{848    \mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[168][5] = 1;}
\DoxyCodeLine{849    \mbox{\hyperlink{cave__mesher_8c_ae01a977fd1f7c889f186baee1076b732}{minecraft\_geom\_for\_blocktype}}[168] = \mbox{\hyperlink{stb__voxel__render_8h_abe974f22edeef8189603ba75fd90ff3ca7511f84da0693e6147590c76a74480d6}{STBVOX\_GEOM\_floor\_vheight\_12}};}
\DoxyCodeLine{850    \mbox{\hyperlink{cave__mesher_8c_af38282980cc171915d4acfe5f3e03c90}{effective\_blocktype}}[169] = 169;}
\DoxyCodeLine{851    \mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[169][0] = 1;}
\DoxyCodeLine{852    \mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[169][1] = 1;}
\DoxyCodeLine{853    \mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[169][2] = 1;}
\DoxyCodeLine{854    \mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[169][3] = 1;}
\DoxyCodeLine{855    \mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[169][4] = 1;}
\DoxyCodeLine{856    \mbox{\hyperlink{cave__mesher_8c_add8be801e9bdf08c2966ff797143933a}{minecraft\_tex1\_for\_blocktype}}[169][5] = 1;}
\DoxyCodeLine{857    \mbox{\hyperlink{cave__mesher_8c_ae01a977fd1f7c889f186baee1076b732}{minecraft\_geom\_for\_blocktype}}[169] = \mbox{\hyperlink{stb__voxel__render_8h_abe974f22edeef8189603ba75fd90ff3ca62855fb026ed6bb2b93a02f94b9eaacb}{STBVOX\_GEOM\_ceil\_vheight\_03}};}
\DoxyCodeLine{858 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{859 }
\DoxyCodeLine{860    \mbox{\hyperlink{cave__mesher_8c_a10cae8a4d85b638a4d2f2ce75883552e}{remap}}[53] = 1;}
\DoxyCodeLine{861    \mbox{\hyperlink{cave__mesher_8c_a10cae8a4d85b638a4d2f2ce75883552e}{remap}}[67] = 2;}
\DoxyCodeLine{862    \mbox{\hyperlink{cave__mesher_8c_a10cae8a4d85b638a4d2f2ce75883552e}{remap}}[108] = 3;}
\DoxyCodeLine{863    \mbox{\hyperlink{cave__mesher_8c_a10cae8a4d85b638a4d2f2ce75883552e}{remap}}[109] = 4;}
\DoxyCodeLine{864    \mbox{\hyperlink{cave__mesher_8c_a10cae8a4d85b638a4d2f2ce75883552e}{remap}}[114] = 5;}
\DoxyCodeLine{865    \mbox{\hyperlink{cave__mesher_8c_a10cae8a4d85b638a4d2f2ce75883552e}{remap}}[136] = 6;}
\DoxyCodeLine{866    \mbox{\hyperlink{cave__mesher_8c_a10cae8a4d85b638a4d2f2ce75883552e}{remap}}[156] = 7;}
\DoxyCodeLine{867    \textcolor{keywordflow}{for} (i=0; i < 256; ++i)}
\DoxyCodeLine{868       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cave__mesher_8c_a10cae8a4d85b638a4d2f2ce75883552e}{remap}}[i])}
\DoxyCodeLine{869          \mbox{\hyperlink{cave__mesher_8c_a626c17451761446962cffc9add2ed539}{build\_stair\_rotations}}(i, \mbox{\hyperlink{cave__mesher_8c_a2015282d41ced055a462520de780e814}{remap\_data}}[\mbox{\hyperlink{cave__mesher_8c_a10cae8a4d85b638a4d2f2ce75883552e}{remap}}[i]]);}
\DoxyCodeLine{870    \mbox{\hyperlink{cave__mesher_8c_a10cae8a4d85b638a4d2f2ce75883552e}{remap}}[35]  = 8;}
\DoxyCodeLine{871    \mbox{\hyperlink{cave__mesher_8c_addb3a71c75c33215207185a88be4bb62}{build\_wool\_variations}}(35, \mbox{\hyperlink{cave__mesher_8c_a2015282d41ced055a462520de780e814}{remap\_data}}[\mbox{\hyperlink{cave__mesher_8c_a10cae8a4d85b638a4d2f2ce75883552e}{remap}}[35]]);}
\DoxyCodeLine{872    \mbox{\hyperlink{cave__mesher_8c_a10cae8a4d85b638a4d2f2ce75883552e}{remap}}[5] = 11;}
\DoxyCodeLine{873    \mbox{\hyperlink{cave__mesher_8c_adcf4dda69d85bc49b9f4babc57587095}{build\_wood\_variations}}(5, \mbox{\hyperlink{cave__mesher_8c_a2015282d41ced055a462520de780e814}{remap\_data}}[\mbox{\hyperlink{cave__mesher_8c_a10cae8a4d85b638a4d2f2ce75883552e}{remap}}[5]]);}
\DoxyCodeLine{874 }
\DoxyCodeLine{875    \textcolor{comment}{// set the remap flags for these so they write the rotation values}}
\DoxyCodeLine{876    \mbox{\hyperlink{cave__mesher_8c_a16709242463cda7c163b826a5da978c5}{remap\_in\_place}}(54, 9);}
\DoxyCodeLine{877    \mbox{\hyperlink{cave__mesher_8c_a16709242463cda7c163b826a5da978c5}{remap\_in\_place}}(146, 10);}
\DoxyCodeLine{878 \}}

\end{DoxyCode}
\mbox{\Hypertarget{caveview_8h_aefd62d461236c6e9ced738eac9d8042c}\label{caveview_8h_aefd62d461236c6e9ced738eac9d8042c}} 
\index{caveview.h@{caveview.h}!ods@{ods}}
\index{ods@{ods}!caveview.h@{caveview.h}}
\doxysubsubsection{\texorpdfstring{ods()}{ods()}}
{\footnotesize\ttfamily \mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} ods (\begin{DoxyParamCaption}\item[{char $\ast$}]{fmt,  }\item[{}]{... }\end{DoxyParamCaption})}



Definition at line 311 of file cave\+\_\+main.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{312 \{}
\DoxyCodeLine{313    \textcolor{keywordtype}{char} \mbox{\hyperlink{structbuffer}{buffer}}[1000];}
\DoxyCodeLine{314    va\_list va;}
\DoxyCodeLine{315    va\_start(va, fmt);}
\DoxyCodeLine{316    \mbox{\hyperlink{rrsprintf_8h_a3e41f3ed65b0d392da13d3341751b5a5}{vsprintf}}(\mbox{\hyperlink{structbuffer}{buffer}}, fmt, va);}
\DoxyCodeLine{317    va\_end(va);}
\DoxyCodeLine{318    SDL\_Log(\textcolor{stringliteral}{"\%s"}, \mbox{\hyperlink{structbuffer}{buffer}});}
\DoxyCodeLine{319 \}}

\end{DoxyCode}
\mbox{\Hypertarget{caveview_8h_a2a4f9ffe000359ba183865da3f860ab5}\label{caveview_8h_a2a4f9ffe000359ba183865da3f860ab5}} 
\index{caveview.h@{caveview.h}!render\_caves@{render\_caves}}
\index{render\_caves@{render\_caves}!caveview.h@{caveview.h}}
\doxysubsubsection{\texorpdfstring{render\_caves()}{render\_caves()}}
{\footnotesize\ttfamily \mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} render\+\_\+caves (\begin{DoxyParamCaption}\item[{float}]{pos\mbox{[}3\mbox{]} }\end{DoxyParamCaption})}



Definition at line 752 of file cave\+\_\+render.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{753 \{}
\DoxyCodeLine{754    \textcolor{keywordtype}{float} \mbox{\hyperlink{glad_8h_a1af10666aa42292f407f6acc2af11948}{x}} = campos[0], \mbox{\hyperlink{glad_8h_af2e2675ea2e0b9a7ec6a98fcb44a938a}{y}} = campos[1];}
\DoxyCodeLine{755    \textcolor{keywordtype}{int} qchunk\_x, qchunk\_y;}
\DoxyCodeLine{756    \textcolor{keywordtype}{int} cam\_x, cam\_y;}
\DoxyCodeLine{757    \textcolor{keywordtype}{int} i,j, rad;}
\DoxyCodeLine{758 }
\DoxyCodeLine{759    compute\_frustum();}
\DoxyCodeLine{760 }
\DoxyCodeLine{761    \mbox{\hyperlink{cave__render_8c_a1a7fcf5f88dd3987df4f5a83618c8487}{chunk\_locations}} = \mbox{\hyperlink{cave__render_8c_a90766e990c4a0a3299dae681bef26211}{chunks\_considered}} = \mbox{\hyperlink{cave__render_8c_aabc2460c0dbf3bb17bf2c768624a37a2}{chunks\_in\_frustum}} = 0;}
\DoxyCodeLine{762    \mbox{\hyperlink{cave__render_8c_a7eb76aa1c7fbf02b3f4cf94c13ba7836}{quads\_considered}} = \mbox{\hyperlink{cave__render_8c_a55f891b23463a28bdca885af7b70b4db}{quads\_rendered}} = 0;}
\DoxyCodeLine{763    \mbox{\hyperlink{cave__render_8c_a6289a09b47b1176d64fa499faa7c73ce}{chunk\_storage\_total}} = \mbox{\hyperlink{cave__render_8c_aac1c4d107c5e708ee713ec9a6ccddc84}{chunk\_storage\_considered}} = \mbox{\hyperlink{cave__render_8c_a2a36f03ff6514a6581bbfdb8c6912a5e}{chunk\_storage\_rendered}} = 0;}
\DoxyCodeLine{764 }
\DoxyCodeLine{765    cam\_x = (int) floor(\mbox{\hyperlink{glad_8h_a1af10666aa42292f407f6acc2af11948}{x}}+0.5);}
\DoxyCodeLine{766    cam\_y = (int) floor(\mbox{\hyperlink{glad_8h_af2e2675ea2e0b9a7ec6a98fcb44a938a}{y}}+0.5);}
\DoxyCodeLine{767 }
\DoxyCodeLine{768    qchunk\_x = (((int) floor(\mbox{\hyperlink{glad_8h_a1af10666aa42292f407f6acc2af11948}{x}})+16) >> 5) << 1;}
\DoxyCodeLine{769    qchunk\_y = (((int) floor(\mbox{\hyperlink{glad_8h_af2e2675ea2e0b9a7ec6a98fcb44a938a}{y}})+16) >> 5) << 1;}
\DoxyCodeLine{770 }
\DoxyCodeLine{771    \mbox{\hyperlink{glad_8h_a3f7fa0df22505dd09a24a4e1e74eca09}{glEnable}}(\mbox{\hyperlink{gl_8h_a4fda8987c8cb3d921967cd0a5343f174}{GL\_ALPHA\_TEST}});}
\DoxyCodeLine{772    \mbox{\hyperlink{gl_8h_a32ca79bf6bda18aaf30a055c48a4fd30}{glAlphaFunc}}(\mbox{\hyperlink{glad_8h_aa3bfa1f454ff5072bc1b64e7d30e9584}{GL\_GREATER}}, 0.5);}
\DoxyCodeLine{773 }
\DoxyCodeLine{774    \mbox{\hyperlink{stb__glprog_8h_ab6c9aabf76a35fa89ef35acd64cdd1a7}{stbglUseProgram}}(\mbox{\hyperlink{cave__render_8c_a98050f44d02d9c2ee70b8435c84d82e5}{main\_prog}});}
\DoxyCodeLine{775    \mbox{\hyperlink{cave__render_8c_a58563743e658ed82deb1c45915be5311}{setup\_uniforms}}(campos); \textcolor{comment}{// set uniforms to default values inefficiently}}
\DoxyCodeLine{776    glActiveTextureARB(\mbox{\hyperlink{glext_8h_a5c56f2e8fd1ca5abe5f47e76036ec2d5}{GL\_TEXTURE2\_ARB}});}
\DoxyCodeLine{777    \mbox{\hyperlink{stb__glprog_8h_a9c550b3836b06a4993b1401605653c7e}{stbglEnableVertexAttribArray}}(0);}
\DoxyCodeLine{778 }
\DoxyCodeLine{779    \{}
\DoxyCodeLine{780       \textcolor{keywordtype}{float} lighting[2][3] = \{ \{ campos[0],campos[1],campos[2] \}, \{ 0.75,0.75,0.65f \} \};}
\DoxyCodeLine{781       \textcolor{keywordtype}{float} bright = 8;}
\DoxyCodeLine{782       lighting[1][0] *= bright;}
\DoxyCodeLine{783       lighting[1][1] *= bright;}
\DoxyCodeLine{784       lighting[1][2] *= bright;}
\DoxyCodeLine{785       \mbox{\hyperlink{stb__glprog_8h_a252326a1e2ad9dde401ac5c6fbe12c84}{stbglUniform3fv}}(\mbox{\hyperlink{stb__glprog_8h_a188b0d913a30b6ebbdd3629aad89fe45}{stbgl\_find\_uniform}}(\mbox{\hyperlink{cave__render_8c_a98050f44d02d9c2ee70b8435c84d82e5}{main\_prog}}, \textcolor{stringliteral}{"light\_source"}), 2, lighting[0]);}
\DoxyCodeLine{786    \}}
\DoxyCodeLine{787 }
\DoxyCodeLine{788    \textcolor{keywordflow}{if} (\mbox{\hyperlink{cave__render_8c_ab714d9bf6480e3842f9174937f6257c9}{global\_hack}})}
\DoxyCodeLine{789       \mbox{\hyperlink{cave__render_8c_a780d126fbb25c976ce349b06059ecc66}{set\_tex2\_alpha}}(\mbox{\hyperlink{cave__render_8c_aae02e1ae69339213673af37e15e343b4}{tex2\_alpha}});}
\DoxyCodeLine{790 }
\DoxyCodeLine{791    \mbox{\hyperlink{cave__render_8c_a0ced74c1235cfa302b0fda9cba9682e4}{num\_meshes\_uploaded}} = 0;}
\DoxyCodeLine{792    \mbox{\hyperlink{cave__render_8c_a654d2857d277992878a8c7ff1f740282}{update\_meshes\_from\_render\_thread}}();}
\DoxyCodeLine{793 }
\DoxyCodeLine{794    \textcolor{comment}{// traverse all in-\/range chunks and analyze them}}
\DoxyCodeLine{795    \textcolor{keywordflow}{for} (j=-\/\mbox{\hyperlink{cave__render_8c_a7287aa4341d0bc802616e36453418217}{view\_dist\_in\_chunks}}; j <= \mbox{\hyperlink{cave__render_8c_a7287aa4341d0bc802616e36453418217}{view\_dist\_in\_chunks}}; j += 2) \{}
\DoxyCodeLine{796       \textcolor{keywordflow}{for} (i=-\/\mbox{\hyperlink{cave__render_8c_a7287aa4341d0bc802616e36453418217}{view\_dist\_in\_chunks}}; i <= \mbox{\hyperlink{cave__render_8c_a7287aa4341d0bc802616e36453418217}{view\_dist\_in\_chunks}}; i += 2) \{}
\DoxyCodeLine{797          \textcolor{keywordtype}{float} priority;}
\DoxyCodeLine{798          \textcolor{keywordtype}{int} cx = qchunk\_x + i;}
\DoxyCodeLine{799          \textcolor{keywordtype}{int} cy = qchunk\_y + j;}
\DoxyCodeLine{800 }
\DoxyCodeLine{801          priority = \mbox{\hyperlink{cave__render_8c_a7fd43582038fa12183f22d2b5bc70793}{compute\_priority}}(cx, cy, \mbox{\hyperlink{glad_8h_a1af10666aa42292f407f6acc2af11948}{x}}, \mbox{\hyperlink{glad_8h_af2e2675ea2e0b9a7ec6a98fcb44a938a}{y}});}
\DoxyCodeLine{802          \textcolor{keywordflow}{if} (priority >= \mbox{\hyperlink{cave__render_8c_a538e3a4857cf9635776e05cf1ada9a83}{min\_priority}}) \{}
\DoxyCodeLine{803             \textcolor{keywordtype}{int} slot\_x = (cx>>1) \& (\mbox{\hyperlink{cave__render_8c_a8fa3a95e690c74108521420c97453ac8}{CACHED\_MESH\_NUM\_X}}-\/1);}
\DoxyCodeLine{804             \textcolor{keywordtype}{int} slot\_y = (cy>>1) \& (\mbox{\hyperlink{cave__render_8c_ab63e500c94da0daaf2114b8168f3bd06}{CACHED\_MESH\_NUM\_Y}}-\/1);}
\DoxyCodeLine{805             \mbox{\hyperlink{structchunk__mesh}{chunk\_mesh}} *cm = \&\mbox{\hyperlink{cave__render_8c_acbd6ac4d8dd8e0747a1d33adb6bb90f5}{cached\_chunk\_mesh}}[slot\_y][slot\_x];}
\DoxyCodeLine{806             ++\mbox{\hyperlink{cave__render_8c_a1a7fcf5f88dd3987df4f5a83618c8487}{chunk\_locations}};}
\DoxyCodeLine{807             \textcolor{keywordflow}{if} (cm-\/>\mbox{\hyperlink{structchunk__mesh_afb20c6f240e8ffbae40e299c9f2ccb1d}{state}} == \mbox{\hyperlink{cave__render_8c_ab39a415800ebd0d977c477376649649ba9403d38ed10dea456e4b628995e4583c}{STATE\_valid}} \&\& priority >= 0) \{}
\DoxyCodeLine{808                \textcolor{comment}{// check if chunk pos actually matches}}
\DoxyCodeLine{809                \textcolor{keywordflow}{if} (cm-\/>\mbox{\hyperlink{structchunk__mesh_a2c3d88a733672817af404c4342ef34b5}{chunk\_x}} != cx || cm-\/>\mbox{\hyperlink{structchunk__mesh_a115a5548f6ce659c096d3d45defdc7d6}{chunk\_y}} != cy) \{}
\DoxyCodeLine{810                   \textcolor{comment}{// we have a stale chunk we need to recreate}}
\DoxyCodeLine{811                   \mbox{\hyperlink{cave__render_8c_a8da956987731d72d3d6af47e0c31ace3}{free\_chunk}}(slot\_x, slot\_y); \textcolor{comment}{// it probably will have already gotten freed, but just in case}}
\DoxyCodeLine{812                \}}
\DoxyCodeLine{813             \}}
\DoxyCodeLine{814             \textcolor{keywordflow}{if} (cm-\/>\mbox{\hyperlink{structchunk__mesh_afb20c6f240e8ffbae40e299c9f2ccb1d}{state}} == \mbox{\hyperlink{cave__render_8c_ab39a415800ebd0d977c477376649649ba1a69b1351d5fad0def30e9d7d44bc2f3}{STATE\_invalid}}) \{}
\DoxyCodeLine{815                cm-\/>\mbox{\hyperlink{structchunk__mesh_a2c3d88a733672817af404c4342ef34b5}{chunk\_x}} = cx;}
\DoxyCodeLine{816                cm-\/>\mbox{\hyperlink{structchunk__mesh_a115a5548f6ce659c096d3d45defdc7d6}{chunk\_y}} = cy;}
\DoxyCodeLine{817                cm-\/>\mbox{\hyperlink{structchunk__mesh_afb20c6f240e8ffbae40e299c9f2ccb1d}{state}} = \mbox{\hyperlink{cave__render_8c_ab39a415800ebd0d977c477376649649ba30055d9bf9753d6c86c158dd8273ad42}{STATE\_needed}};}
\DoxyCodeLine{818             \}}
\DoxyCodeLine{819             cm-\/>\mbox{\hyperlink{structchunk__mesh_a528568b012aae49c80192ba9430def31}{priority}} = priority;}
\DoxyCodeLine{820          \}}
\DoxyCodeLine{821       \}}
\DoxyCodeLine{822    \}}
\DoxyCodeLine{823 }
\DoxyCodeLine{824    \textcolor{comment}{// draw front-\/to-\/back}}
\DoxyCodeLine{825    \textcolor{keywordflow}{for} (rad = 0; rad <= \mbox{\hyperlink{cave__render_8c_a7287aa4341d0bc802616e36453418217}{view\_dist\_in\_chunks}}; rad += 2) \{}
\DoxyCodeLine{826       \textcolor{keywordflow}{for} (j=-\/rad; j <= rad; j += 2) \{}
\DoxyCodeLine{827          \textcolor{comment}{// if j is +-\/ rad, then iterate i through all values}}
\DoxyCodeLine{828          \textcolor{comment}{// if j isn't +-\/rad, then i should be only -\/rad \& rad}}
\DoxyCodeLine{829          \textcolor{keywordtype}{int} \mbox{\hyperlink{cave__render_8c_a863c86bdfd96bf9c461846689c2614aa}{step}} = 2;}
\DoxyCodeLine{830          \textcolor{keywordflow}{if} (abs(j) != rad)}
\DoxyCodeLine{831             \mbox{\hyperlink{cave__render_8c_a863c86bdfd96bf9c461846689c2614aa}{step}} = 2*rad;}
\DoxyCodeLine{832          \textcolor{keywordflow}{for} (i=-\/rad; i <= rad; i += \mbox{\hyperlink{cave__render_8c_a863c86bdfd96bf9c461846689c2614aa}{step}}) \{}
\DoxyCodeLine{833             \textcolor{keywordtype}{int} cx = qchunk\_x + i;}
\DoxyCodeLine{834             \textcolor{keywordtype}{int} cy = qchunk\_y + j;}
\DoxyCodeLine{835             \textcolor{keywordtype}{int} slot\_x = (cx>>1) \& (\mbox{\hyperlink{cave__render_8c_a8fa3a95e690c74108521420c97453ac8}{CACHED\_MESH\_NUM\_X}}-\/1);}
\DoxyCodeLine{836             \textcolor{keywordtype}{int} slot\_y = (cy>>1) \& (\mbox{\hyperlink{cave__render_8c_ab63e500c94da0daaf2114b8168f3bd06}{CACHED\_MESH\_NUM\_Y}}-\/1);}
\DoxyCodeLine{837             \mbox{\hyperlink{structchunk__mesh}{chunk\_mesh}} *cm = \&\mbox{\hyperlink{cave__render_8c_acbd6ac4d8dd8e0747a1d33adb6bb90f5}{cached\_chunk\_mesh}}[slot\_y][slot\_x];}
\DoxyCodeLine{838             \textcolor{keywordflow}{if} (cm-\/>\mbox{\hyperlink{structchunk__mesh_afb20c6f240e8ffbae40e299c9f2ccb1d}{state}} == \mbox{\hyperlink{cave__render_8c_ab39a415800ebd0d977c477376649649ba9403d38ed10dea456e4b628995e4583c}{STATE\_valid}} \&\& cm-\/>\mbox{\hyperlink{structchunk__mesh_a528568b012aae49c80192ba9430def31}{priority}} >= 0) \{}
\DoxyCodeLine{839                ++\mbox{\hyperlink{cave__render_8c_a90766e990c4a0a3299dae681bef26211}{chunks\_considered}};}
\DoxyCodeLine{840                \mbox{\hyperlink{cave__render_8c_a7eb76aa1c7fbf02b3f4cf94c13ba7836}{quads\_considered}} += cm-\/>\mbox{\hyperlink{structchunk__mesh_a1062810af936566385c5ba2c668e9f6a}{num\_quads}};}
\DoxyCodeLine{841                \textcolor{keywordflow}{if} (is\_box\_in\_frustum(cm-\/>\mbox{\hyperlink{structchunk__mesh_a34536b1b6efff0e258048519e0a4e33c}{bounds}}[0], cm-\/>\mbox{\hyperlink{structchunk__mesh_a34536b1b6efff0e258048519e0a4e33c}{bounds}}[1])) \{}
\DoxyCodeLine{842                   ++\mbox{\hyperlink{cave__render_8c_aabc2460c0dbf3bb17bf2c768624a37a2}{chunks\_in\_frustum}};}
\DoxyCodeLine{843 }
\DoxyCodeLine{844                   \textcolor{comment}{// @TODO if in range}}
\DoxyCodeLine{845                   \mbox{\hyperlink{stb__glprog_8h_a252326a1e2ad9dde401ac5c6fbe12c84}{stbglUniform3fv}}(\mbox{\hyperlink{cave__render_8c_a2c4b0dabe154aae79a7efd8428a6700a}{uniform\_loc}}[\mbox{\hyperlink{stb__voxel__render_8h_a7859c0a3efa8b1c360f5c2376baf051eab955886cfcf0c2c881d633beeb99ad93}{STBVOX\_UNIFORM\_transform}}], 3, cm-\/>\mbox{\hyperlink{structchunk__mesh_a38970d9ccd61ecd637f8d561d3ee6749}{transform}}[0]);}
\DoxyCodeLine{846                   glBindBufferARB(\mbox{\hyperlink{glext_8h_acb1c5ea3239de87d09959457ffa42f6f}{GL\_ARRAY\_BUFFER\_ARB}}, cm-\/>\mbox{\hyperlink{structchunk__mesh_a1ed99534ee04fe22dae227b3915a8088}{vbuf}});}
\DoxyCodeLine{847                   \mbox{\hyperlink{glad_8h_a4c19069a22ebd709443b65a9c170be49}{glVertexAttribIPointer}}(0, 1, \mbox{\hyperlink{glad_8h_a69b1c02ba0bd93c643c6d82e0c16eb99}{GL\_UNSIGNED\_INT}}, 4, (\textcolor{keywordtype}{void}*) 0);}
\DoxyCodeLine{848                   \mbox{\hyperlink{glad_8h_a987aecafceffb9afaef11412d42e605b}{glBindTexture}}(\mbox{\hyperlink{glext_8h_a516c2e3065f87bfa599e8f521058d684}{GL\_TEXTURE\_BUFFER\_ARB}}, cm-\/>\mbox{\hyperlink{structchunk__mesh_a5d94f262ea3b806f7541f81bca2b528a}{fbuf\_tex}});}
\DoxyCodeLine{849                   \mbox{\hyperlink{glad_8h_a89377449aceadc060b577926b5413bd2}{glDrawArrays}}(\mbox{\hyperlink{glad_8h_a36b428225d54dd9cf2e564e5ada3ad3d}{GL\_QUADS}}, 0, cm-\/>\mbox{\hyperlink{structchunk__mesh_a1062810af936566385c5ba2c668e9f6a}{num\_quads}}*4);}
\DoxyCodeLine{850                   \mbox{\hyperlink{cave__render_8c_a55f891b23463a28bdca885af7b70b4db}{quads\_rendered}} += cm-\/>\mbox{\hyperlink{structchunk__mesh_a1062810af936566385c5ba2c668e9f6a}{num\_quads}};}
\DoxyCodeLine{851 }
\DoxyCodeLine{852                   \mbox{\hyperlink{cave__render_8c_a2a36f03ff6514a6581bbfdb8c6912a5e}{chunk\_storage\_rendered}} += cm-\/>\mbox{\hyperlink{structchunk__mesh_a4c69ff6d6b3aa9a608951009de68c3a1}{vbuf\_size}} + cm-\/>\mbox{\hyperlink{structchunk__mesh_a345fe9574e3eaac10f8ff2a4d641fdf4}{fbuf\_size}};}
\DoxyCodeLine{853                \}}
\DoxyCodeLine{854                \mbox{\hyperlink{cave__render_8c_aac1c4d107c5e708ee713ec9a6ccddc84}{chunk\_storage\_considered}} += cm-\/>\mbox{\hyperlink{structchunk__mesh_a4c69ff6d6b3aa9a608951009de68c3a1}{vbuf\_size}} + cm-\/>\mbox{\hyperlink{structchunk__mesh_a345fe9574e3eaac10f8ff2a4d641fdf4}{fbuf\_size}};}
\DoxyCodeLine{855             \}}
\DoxyCodeLine{856          \}}
\DoxyCodeLine{857       \}}
\DoxyCodeLine{858    \}}
\DoxyCodeLine{859 }
\DoxyCodeLine{860    \mbox{\hyperlink{stb__glprog_8h_a6e0cf99bd61c0ac06ddee977bf2ad82e}{stbglDisableVertexAttribArray}}(0);}
\DoxyCodeLine{861    glBindBufferARB(\mbox{\hyperlink{glext_8h_acb1c5ea3239de87d09959457ffa42f6f}{GL\_ARRAY\_BUFFER\_ARB}}, 0);}
\DoxyCodeLine{862    glActiveTextureARB(\mbox{\hyperlink{glext_8h_a52f7e4ad7d25b51800d52f7cf4459a39}{GL\_TEXTURE0\_ARB}});}
\DoxyCodeLine{863 }
\DoxyCodeLine{864    \mbox{\hyperlink{stb__glprog_8h_ab6c9aabf76a35fa89ef35acd64cdd1a7}{stbglUseProgram}}(0);}
\DoxyCodeLine{865    \mbox{\hyperlink{cave__render_8c_a71cf846b08a6962abf1c34ab13da6933}{num\_meshes\_started}} = 0;}
\DoxyCodeLine{866 }
\DoxyCodeLine{867    \{}
\DoxyCodeLine{868 \textcolor{preprocessor}{      \#define MAX\_QUEUE  8}}
\DoxyCodeLine{869       \textcolor{keywordtype}{float} highest\_priority[\mbox{\hyperlink{cave__render_8c_ab94814559b67e4a2a564087f821145ea}{MAX\_QUEUE}}];}
\DoxyCodeLine{870       \textcolor{keywordtype}{int} highest\_i[\mbox{\hyperlink{cave__render_8c_ab94814559b67e4a2a564087f821145ea}{MAX\_QUEUE}}], highest\_j[\mbox{\hyperlink{cave__render_8c_ab94814559b67e4a2a564087f821145ea}{MAX\_QUEUE}}];}
\DoxyCodeLine{871       \textcolor{keywordtype}{float} lowest\_priority = \mbox{\hyperlink{cave__render_8c_a7287aa4341d0bc802616e36453418217}{view\_dist\_in\_chunks}} * \mbox{\hyperlink{cave__render_8c_a7287aa4341d0bc802616e36453418217}{view\_dist\_in\_chunks}} * 16 * 16.0f;}
\DoxyCodeLine{872       \textcolor{keywordtype}{int} lowest\_i = -\/1, lowest\_j = -\/1;}
\DoxyCodeLine{873 }
\DoxyCodeLine{874       \textcolor{keywordflow}{for} (i=0; i < \mbox{\hyperlink{cave__render_8c_ab94814559b67e4a2a564087f821145ea}{MAX\_QUEUE}}; ++i) \{}
\DoxyCodeLine{875          highest\_priority[i] = \mbox{\hyperlink{cave__render_8c_a538e3a4857cf9635776e05cf1ada9a83}{min\_priority}};}
\DoxyCodeLine{876          highest\_i[i] = -\/1;}
\DoxyCodeLine{877          highest\_j[i] = -\/1;}
\DoxyCodeLine{878       \}}
\DoxyCodeLine{879 }
\DoxyCodeLine{880       \textcolor{keywordflow}{for} (j=0; j < \mbox{\hyperlink{cave__render_8c_ab63e500c94da0daaf2114b8168f3bd06}{CACHED\_MESH\_NUM\_Y}}; ++j) \{}
\DoxyCodeLine{881          \textcolor{keywordflow}{for} (i=0; i < \mbox{\hyperlink{cave__render_8c_a8fa3a95e690c74108521420c97453ac8}{CACHED\_MESH\_NUM\_X}}; ++i) \{}
\DoxyCodeLine{882             \mbox{\hyperlink{structchunk__mesh}{chunk\_mesh}} *cm = \&\mbox{\hyperlink{cave__render_8c_acbd6ac4d8dd8e0747a1d33adb6bb90f5}{cached\_chunk\_mesh}}[j][i];}
\DoxyCodeLine{883             \textcolor{keywordflow}{if} (cm-\/>\mbox{\hyperlink{structchunk__mesh_afb20c6f240e8ffbae40e299c9f2ccb1d}{state}} == \mbox{\hyperlink{cave__render_8c_ab39a415800ebd0d977c477376649649ba9403d38ed10dea456e4b628995e4583c}{STATE\_valid}}) \{}
\DoxyCodeLine{884                cm-\/>\mbox{\hyperlink{structchunk__mesh_a528568b012aae49c80192ba9430def31}{priority}} = \mbox{\hyperlink{cave__render_8c_a7fd43582038fa12183f22d2b5bc70793}{compute\_priority}}(cm-\/>\mbox{\hyperlink{structchunk__mesh_a2c3d88a733672817af404c4342ef34b5}{chunk\_x}}, cm-\/>\mbox{\hyperlink{structchunk__mesh_a115a5548f6ce659c096d3d45defdc7d6}{chunk\_y}}, \mbox{\hyperlink{glad_8h_a1af10666aa42292f407f6acc2af11948}{x}}, \mbox{\hyperlink{glad_8h_af2e2675ea2e0b9a7ec6a98fcb44a938a}{y}});}
\DoxyCodeLine{885                \mbox{\hyperlink{cave__render_8c_a6289a09b47b1176d64fa499faa7c73ce}{chunk\_storage\_total}} += cm-\/>\mbox{\hyperlink{structchunk__mesh_a4c69ff6d6b3aa9a608951009de68c3a1}{vbuf\_size}} + cm-\/>\mbox{\hyperlink{structchunk__mesh_a345fe9574e3eaac10f8ff2a4d641fdf4}{fbuf\_size}};}
\DoxyCodeLine{886                \textcolor{keywordflow}{if} (cm-\/>\mbox{\hyperlink{structchunk__mesh_a528568b012aae49c80192ba9430def31}{priority}} < lowest\_priority) \{}
\DoxyCodeLine{887                   lowest\_priority = cm-\/>\mbox{\hyperlink{structchunk__mesh_a528568b012aae49c80192ba9430def31}{priority}};}
\DoxyCodeLine{888                   lowest\_i = i;}
\DoxyCodeLine{889                   lowest\_j = j;}
\DoxyCodeLine{890                \}}
\DoxyCodeLine{891             \}}
\DoxyCodeLine{892             \textcolor{keywordflow}{if} (cm-\/>\mbox{\hyperlink{structchunk__mesh_afb20c6f240e8ffbae40e299c9f2ccb1d}{state}} == \mbox{\hyperlink{cave__render_8c_ab39a415800ebd0d977c477376649649ba30055d9bf9753d6c86c158dd8273ad42}{STATE\_needed}}) \{}
\DoxyCodeLine{893                cm-\/>\mbox{\hyperlink{structchunk__mesh_a528568b012aae49c80192ba9430def31}{priority}} = \mbox{\hyperlink{cave__render_8c_a7fd43582038fa12183f22d2b5bc70793}{compute\_priority}}(cm-\/>\mbox{\hyperlink{structchunk__mesh_a2c3d88a733672817af404c4342ef34b5}{chunk\_x}}, cm-\/>\mbox{\hyperlink{structchunk__mesh_a115a5548f6ce659c096d3d45defdc7d6}{chunk\_y}}, \mbox{\hyperlink{glad_8h_a1af10666aa42292f407f6acc2af11948}{x}}, \mbox{\hyperlink{glad_8h_af2e2675ea2e0b9a7ec6a98fcb44a938a}{y}});}
\DoxyCodeLine{894                \textcolor{keywordflow}{if} (cm-\/>\mbox{\hyperlink{structchunk__mesh_a528568b012aae49c80192ba9430def31}{priority}} < \mbox{\hyperlink{cave__render_8c_a538e3a4857cf9635776e05cf1ada9a83}{min\_priority}})}
\DoxyCodeLine{895                   cm-\/>\mbox{\hyperlink{structchunk__mesh_afb20c6f240e8ffbae40e299c9f2ccb1d}{state}} = \mbox{\hyperlink{cave__render_8c_ab39a415800ebd0d977c477376649649ba1a69b1351d5fad0def30e9d7d44bc2f3}{STATE\_invalid}};}
\DoxyCodeLine{896                \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (cm-\/>\mbox{\hyperlink{structchunk__mesh_a528568b012aae49c80192ba9430def31}{priority}} > highest\_priority[0]) \{}
\DoxyCodeLine{897                   \textcolor{keywordtype}{int} k;}
\DoxyCodeLine{898                   highest\_priority[0] = cm-\/>\mbox{\hyperlink{structchunk__mesh_a528568b012aae49c80192ba9430def31}{priority}};}
\DoxyCodeLine{899                   highest\_i[0] = i;}
\DoxyCodeLine{900                   highest\_j[0] = j;}
\DoxyCodeLine{901                   \textcolor{comment}{// bubble this up to right place}}
\DoxyCodeLine{902                   \textcolor{keywordflow}{for} (k=0; k < \mbox{\hyperlink{cave__render_8c_ab94814559b67e4a2a564087f821145ea}{MAX\_QUEUE}}-\/1; ++k) \{}
\DoxyCodeLine{903                      \textcolor{keywordflow}{if} (highest\_priority[k] > highest\_priority[k+1]) \{}
\DoxyCodeLine{904                         highest\_priority[k] = highest\_priority[k+1];}
\DoxyCodeLine{905                         highest\_priority[k+1] = cm-\/>\mbox{\hyperlink{structchunk__mesh_a528568b012aae49c80192ba9430def31}{priority}};}
\DoxyCodeLine{906                         highest\_i[k] = highest\_i[k+1];}
\DoxyCodeLine{907                         highest\_i[k+1] = i;}
\DoxyCodeLine{908                         highest\_j[k] = highest\_j[k+1];}
\DoxyCodeLine{909                         highest\_j[k+1] = j;}
\DoxyCodeLine{910                      \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{911                         \textcolor{keywordflow}{break};}
\DoxyCodeLine{912                      \}}
\DoxyCodeLine{913                   \}}
\DoxyCodeLine{914                \}}
\DoxyCodeLine{915             \}}
\DoxyCodeLine{916          \}}
\DoxyCodeLine{917       \}}
\DoxyCodeLine{918 }
\DoxyCodeLine{919 }
\DoxyCodeLine{920       \textcolor{comment}{// I couldn't find any straightforward logic that avoids}}
\DoxyCodeLine{921       \textcolor{comment}{// the hysteresis problem of continually creating \& freeing}}
\DoxyCodeLine{922       \textcolor{comment}{// a block on the margin, so I just don't free a block until}}
\DoxyCodeLine{923       \textcolor{comment}{// it's out of range, but this doesn't actually correctly}}
\DoxyCodeLine{924       \textcolor{comment}{// handle when the cache is too small for the given range}}
\DoxyCodeLine{925       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cave__render_8c_a6289a09b47b1176d64fa499faa7c73ce}{chunk\_storage\_total}} >= \mbox{\hyperlink{cave__render_8c_a8a1468c6c20eb6549bdb72976fbd13fe}{min\_chunk\_storage}} \&\& lowest\_i >= 0) \{}
\DoxyCodeLine{926          \textcolor{keywordflow}{if} (\mbox{\hyperlink{cave__render_8c_acbd6ac4d8dd8e0747a1d33adb6bb90f5}{cached\_chunk\_mesh}}[lowest\_j][lowest\_i].priority < -\/1200) \textcolor{comment}{// -\/1000? 0?}}
\DoxyCodeLine{927             \mbox{\hyperlink{cave__render_8c_a8da956987731d72d3d6af47e0c31ace3}{free\_chunk}}(lowest\_i, lowest\_j);}
\DoxyCodeLine{928       \}}
\DoxyCodeLine{929 }
\DoxyCodeLine{930       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cave__render_8c_a6289a09b47b1176d64fa499faa7c73ce}{chunk\_storage\_total}} < \mbox{\hyperlink{cave__render_8c_aaad3ccb28ec5b3ab89cdb42cd3c21771}{max\_chunk\_storage}} \&\& highest\_i[0] >= 0) \{}
\DoxyCodeLine{931          \textcolor{keywordflow}{for} (j=\mbox{\hyperlink{cave__render_8c_ab94814559b67e4a2a564087f821145ea}{MAX\_QUEUE}}-\/1; j >= 0; -\/-\/j) \{}
\DoxyCodeLine{932             \textcolor{keywordflow}{if} (highest\_j[0] >= 0) \{}
\DoxyCodeLine{933                \mbox{\hyperlink{structchunk__mesh}{chunk\_mesh}} *cm = \&\mbox{\hyperlink{cave__render_8c_acbd6ac4d8dd8e0747a1d33adb6bb90f5}{cached\_chunk\_mesh}}[highest\_j[j]][highest\_i[j]];}
\DoxyCodeLine{934                \textcolor{keywordflow}{if} (\mbox{\hyperlink{cave__render_8c_a18386edf73cd3e3f424ea7cb0f5dab1e}{request\_chunk}}(cm-\/>\mbox{\hyperlink{structchunk__mesh_a2c3d88a733672817af404c4342ef34b5}{chunk\_x}}, cm-\/>\mbox{\hyperlink{structchunk__mesh_a115a5548f6ce659c096d3d45defdc7d6}{chunk\_y}})) \{}
\DoxyCodeLine{935                   cm-\/>\mbox{\hyperlink{structchunk__mesh_afb20c6f240e8ffbae40e299c9f2ccb1d}{state}} = \mbox{\hyperlink{cave__render_8c_ab39a415800ebd0d977c477376649649ba12236ecbf4b9525bd229902691ec52a8}{STATE\_requested}};}
\DoxyCodeLine{936                \} \textcolor{keywordflow}{else} \{}
\DoxyCodeLine{937                   \textcolor{comment}{// if we couldn't queue this one, skip the remainder}}
\DoxyCodeLine{938                   \textcolor{keywordflow}{break};}
\DoxyCodeLine{939                \}}
\DoxyCodeLine{940             \}}
\DoxyCodeLine{941          \}}
\DoxyCodeLine{942       \}}
\DoxyCodeLine{943    \}}
\DoxyCodeLine{944 }
\DoxyCodeLine{945    \mbox{\hyperlink{cave__render_8c_a654d2857d277992878a8c7ff1f740282}{update\_meshes\_from\_render\_thread}}();}
\DoxyCodeLine{946 }
\DoxyCodeLine{947    \mbox{\hyperlink{cave__render_8c_a080346cc58cb8f8b780aa706f20a1bdc}{num\_threads\_active}} = 0;}
\DoxyCodeLine{948    \textcolor{keywordflow}{for} (i=0; i < \mbox{\hyperlink{cave__render_8c_a7cd3d17270efa49416663f4e571144cc}{num\_mesh\_workers}}; ++i) \{}
\DoxyCodeLine{949       \mbox{\hyperlink{cave__render_8c_a080346cc58cb8f8b780aa706f20a1bdc}{num\_threads\_active}} += (\mbox{\hyperlink{cave__render_8c_a285a49a21e43d98e9f7ea0f052a733dc}{mesh\_data}}[i].\mbox{\hyperlink{structmesh__worker_ac696a930eac8705f16b1dd5f09139713}{state}} == \mbox{\hyperlink{cave__render_8c_ae33c78feb670de33d2abf21ec0624531af060baead9e16d712b41715e70cf1817}{WSTATE\_running}});}
\DoxyCodeLine{950    \}}
\DoxyCodeLine{951 \}}

\end{DoxyCode}
\mbox{\Hypertarget{caveview_8h_a19d602180d3af1e1e3969518075548cc}\label{caveview_8h_a19d602180d3af1e1e3969518075548cc}} 
\index{caveview.h@{caveview.h}!render\_init@{render\_init}}
\index{render\_init@{render\_init}!caveview.h@{caveview.h}}
\doxysubsubsection{\texorpdfstring{render\_init()}{render\_init()}}
{\footnotesize\ttfamily \mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} render\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}}}]{ }\end{DoxyParamCaption})}



Definition at line 403 of file cave\+\_\+render.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{404 \{}
\DoxyCodeLine{405    \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{406    \textcolor{keywordtype}{char} *binds[] = \{ \textcolor{stringliteral}{"attr\_vertex"}, \textcolor{stringliteral}{"attr\_face"}, \mbox{\hyperlink{include_2vally_2config_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}} \};}
\DoxyCodeLine{407    \textcolor{keywordtype}{char} *\mbox{\hyperlink{wave_8c_aeb310e20c71a4ca39015f9553658d290}{vertex}};}
\DoxyCodeLine{408    \textcolor{keywordtype}{char} *fragment;}
\DoxyCodeLine{409    \textcolor{keywordtype}{int} \mbox{\hyperlink{glad_8h_a713abae75276598501f75c68917c5e2d}{w}}=0,\mbox{\hyperlink{glad_8h_afa0fb1b5e976920c0abeff2dca3ed774}{h}}=0;}
\DoxyCodeLine{410 }
\DoxyCodeLine{411    \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} *texdata = \mbox{\hyperlink{stb__image_8c_a6e3bfbdf11886669cd2153c1136f29db}{stbi\_load}}(\textcolor{stringliteral}{"terrain.png"}, \&\mbox{\hyperlink{glad_8h_a713abae75276598501f75c68917c5e2d}{w}}, \&\mbox{\hyperlink{glad_8h_afa0fb1b5e976920c0abeff2dca3ed774}{h}}, \mbox{\hyperlink{include_2vally_2config_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}}, 4);}
\DoxyCodeLine{412 }
\DoxyCodeLine{413    \mbox{\hyperlink{stb__voxel__render_8h_a1b8b7770f24477cf39260eac3ade3400}{stbvox\_init\_mesh\_maker}}(\&\mbox{\hyperlink{cave__render_8c_abee69a8c0dbc3a083193dea4dddbaf8c}{g\_mesh\_maker}});}
\DoxyCodeLine{414    \textcolor{keywordflow}{for} (i=0; i < \mbox{\hyperlink{cave__render_8c_a7cd3d17270efa49416663f4e571144cc}{num\_mesh\_workers}}; ++i) \{}
\DoxyCodeLine{415       \mbox{\hyperlink{stb__voxel__render_8h_a1b8b7770f24477cf39260eac3ade3400}{stbvox\_init\_mesh\_maker}}(\&\mbox{\hyperlink{cave__render_8c_a285a49a21e43d98e9f7ea0f052a733dc}{mesh\_data}}[i].rm.mm);}
\DoxyCodeLine{416    \}}
\DoxyCodeLine{417 }
\DoxyCodeLine{418    \mbox{\hyperlink{structvertex}{vertex}} = \mbox{\hyperlink{stb__voxel__render_8h_a79f9e4c051c53927e0f762910729860b}{stbvox\_get\_vertex\_shader}}();}
\DoxyCodeLine{419    fragment = \mbox{\hyperlink{stb__voxel__render_8h_a21e1e1586c93abcba24be8eb01d8fd3d}{stbvox\_get\_fragment\_shader}}();}
\DoxyCodeLine{420 }
\DoxyCodeLine{421    \{}
\DoxyCodeLine{422       \textcolor{keywordtype}{char} error\_buffer[1024];}
\DoxyCodeLine{423       \textcolor{keywordtype}{char} *main\_vertex[] = \{ \mbox{\hyperlink{wave_8c_aeb310e20c71a4ca39015f9553658d290}{vertex}}, \mbox{\hyperlink{include_2vally_2config_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}} \};}
\DoxyCodeLine{424       \textcolor{keywordtype}{char} *main\_fragment[] = \{ fragment, \mbox{\hyperlink{include_2vally_2config_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}} \};}
\DoxyCodeLine{425       \mbox{\hyperlink{cave__render_8c_a98050f44d02d9c2ee70b8435c84d82e5}{main\_prog}} = \mbox{\hyperlink{stb__glprog_8h_a40e75cc08efa43f853e710a6462a29e2}{stbgl\_create\_program}}(main\_vertex, main\_fragment, binds, error\_buffer, \textcolor{keyword}{sizeof}(error\_buffer));}
\DoxyCodeLine{426       \textcolor{keywordflow}{if} (\mbox{\hyperlink{cave__render_8c_a98050f44d02d9c2ee70b8435c84d82e5}{main\_prog}} == 0) \{}
\DoxyCodeLine{427          \mbox{\hyperlink{cave__main_8c_aefd62d461236c6e9ced738eac9d8042c}{ods}}(\textcolor{stringliteral}{"Compile error for main shader: \%s\(\backslash\)n"}, error\_buffer);}
\DoxyCodeLine{428          assert(0);}
\DoxyCodeLine{429          exit(1);}
\DoxyCodeLine{430       \}}
\DoxyCodeLine{431    \}}
\DoxyCodeLine{432    \textcolor{comment}{//init\_index\_buffer();}}
\DoxyCodeLine{433 }
\DoxyCodeLine{434    \mbox{\hyperlink{cave__render_8c_a5a929f915201b0dbb791c74db8420500}{make\_texture\_buffer\_for\_uniform}}(\mbox{\hyperlink{stb__voxel__render_8h_a7859c0a3efa8b1c360f5c2376baf051eaf9b476df9befe12c8855d1ea20db22fe}{STBVOX\_UNIFORM\_texscale}}     , 3);}
\DoxyCodeLine{435    \mbox{\hyperlink{cave__render_8c_a5a929f915201b0dbb791c74db8420500}{make\_texture\_buffer\_for\_uniform}}(\mbox{\hyperlink{stb__voxel__render_8h_a7859c0a3efa8b1c360f5c2376baf051ea65f746116b3aa230da8bbb534e6cea97}{STBVOX\_UNIFORM\_texgen}}       , 4);}
\DoxyCodeLine{436    \mbox{\hyperlink{cave__render_8c_a5a929f915201b0dbb791c74db8420500}{make\_texture\_buffer\_for\_uniform}}(\mbox{\hyperlink{stb__voxel__render_8h_a7859c0a3efa8b1c360f5c2376baf051ea1f8122611f70005180ede22ebffa840f}{STBVOX\_UNIFORM\_color\_table}}  , 5);}
\DoxyCodeLine{437 }
\DoxyCodeLine{438    \mbox{\hyperlink{glad_8h_a82ac4415f852b8b5bfe7356202ca934e}{glGenTextures}}(2, \mbox{\hyperlink{cave__render_8c_a640ed05886b5c54012caed647bb8f728}{voxel\_tex}});}
\DoxyCodeLine{439 }
\DoxyCodeLine{440    \mbox{\hyperlink{glad_8h_a987aecafceffb9afaef11412d42e605b}{glBindTexture}}(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}}, \mbox{\hyperlink{cave__render_8c_a640ed05886b5c54012caed647bb8f728}{voxel\_tex}}[0]);}
\DoxyCodeLine{441    glTexImage3DEXT(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}}, 0, \mbox{\hyperlink{glad_8h_a9f2854f4a91a0d83d2d54cb8110bfca4}{GL\_RGBA}},}
\DoxyCodeLine{442                       \mbox{\hyperlink{cave__render_8c_a56dce54d2eef141faab9d338d77e9902}{TEX\_SIZE}},\mbox{\hyperlink{cave__render_8c_a56dce54d2eef141faab9d338d77e9902}{TEX\_SIZE}},256,}
\DoxyCodeLine{443                       0,\mbox{\hyperlink{glad_8h_a9f2854f4a91a0d83d2d54cb8110bfca4}{GL\_RGBA}},\mbox{\hyperlink{glad_8h_a80a33c79f69417372d65d2a65ca36d49}{GL\_UNSIGNED\_BYTE}},\mbox{\hyperlink{include_2vally_2config_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{444    \textcolor{keywordflow}{for} (i=0; i < 256; ++i) \{}
\DoxyCodeLine{445       \textcolor{keywordflow}{if} (texdata)}
\DoxyCodeLine{446          \mbox{\hyperlink{cave__render_8c_afaed9dd655d3234c979e5cc06387c4c9}{scale\_texture}}(texdata, (i\&15)*\mbox{\hyperlink{glad_8h_a713abae75276598501f75c68917c5e2d}{w}}/16, (\mbox{\hyperlink{glad_8h_afa0fb1b5e976920c0abeff2dca3ed774}{h}}/16)*(i>>4), \mbox{\hyperlink{glad_8h_a713abae75276598501f75c68917c5e2d}{w}},\mbox{\hyperlink{glad_8h_afa0fb1b5e976920c0abeff2dca3ed774}{h}});}
\DoxyCodeLine{447       \textcolor{keywordflow}{else}}
\DoxyCodeLine{448          \mbox{\hyperlink{cave__render_8c_a3291895cb2521f7295027d4694bbf242}{build\_base\_texture}}(i);}
\DoxyCodeLine{449       glTexSubImage3DEXT(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}}, 0, 0,0,i, \mbox{\hyperlink{cave__render_8c_a56dce54d2eef141faab9d338d77e9902}{TEX\_SIZE}},\mbox{\hyperlink{cave__render_8c_a56dce54d2eef141faab9d338d77e9902}{TEX\_SIZE}},1, \mbox{\hyperlink{glad_8h_a9f2854f4a91a0d83d2d54cb8110bfca4}{GL\_RGBA}}, \mbox{\hyperlink{glad_8h_a80a33c79f69417372d65d2a65ca36d49}{GL\_UNSIGNED\_BYTE}}, \mbox{\hyperlink{structtexture}{texture}}[0]);}
\DoxyCodeLine{450    \}}
\DoxyCodeLine{451    \mbox{\hyperlink{glad_8h_a5817fa85137822142b4951eacd0154e7}{glTexParameteri}}(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}}, \mbox{\hyperlink{glad_8h_a173a2b2453322dd8d613df6cf2e72480}{GL\_TEXTURE\_MIN\_FILTER}}, \mbox{\hyperlink{glad_8h_a724edc4d9d6f3c1770ff3688f0747acb}{GL\_LINEAR\_MIPMAP\_LINEAR}});}
\DoxyCodeLine{452    \mbox{\hyperlink{glad_8h_a5817fa85137822142b4951eacd0154e7}{glTexParameteri}}(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}}, \mbox{\hyperlink{glad_8h_acb47a41b5963d44826f44b7370bccc26}{GL\_TEXTURE\_MAG\_FILTER}}, \mbox{\hyperlink{glad_8h_a4e682f218130b98b27a1e33fa7325080}{GL\_LINEAR}});}
\DoxyCodeLine{453    \mbox{\hyperlink{glad_8h_a5817fa85137822142b4951eacd0154e7}{glTexParameteri}}(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}}, \mbox{\hyperlink{glext_8h_a00b65957cb070504d8e364031b176737}{GL\_TEXTURE\_MAX\_ANISOTROPY\_EXT}}, 16);}
\DoxyCodeLine{454 \textcolor{preprocessor}{   \#ifdef STBVOX\_CONFIG\_TEX1\_EDGE\_CLAMP}}
\DoxyCodeLine{455    \mbox{\hyperlink{glad_8h_a5817fa85137822142b4951eacd0154e7}{glTexParameteri}}(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}}, \mbox{\hyperlink{glad_8h_a23a0bc2909cc2f79fe7287aaa044e880}{GL\_TEXTURE\_WRAP\_S}}, \mbox{\hyperlink{glad_8h_ae90f81f48642444b4ba7fa5cacf40569}{GL\_CLAMP\_TO\_EDGE}});}
\DoxyCodeLine{456    \mbox{\hyperlink{glad_8h_a5817fa85137822142b4951eacd0154e7}{glTexParameteri}}(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}}, \mbox{\hyperlink{glad_8h_ac307a4772e1d3decd5b6f36192113ab6}{GL\_TEXTURE\_WRAP\_T}}, \mbox{\hyperlink{glad_8h_ae90f81f48642444b4ba7fa5cacf40569}{GL\_CLAMP\_TO\_EDGE}});}
\DoxyCodeLine{457 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{458 }
\DoxyCodeLine{459    glGenerateMipmapEXT(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}});}
\DoxyCodeLine{460 }
\DoxyCodeLine{461    \mbox{\hyperlink{glad_8h_a987aecafceffb9afaef11412d42e605b}{glBindTexture}}(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}}, \mbox{\hyperlink{cave__render_8c_a640ed05886b5c54012caed647bb8f728}{voxel\_tex}}[1]);}
\DoxyCodeLine{462    glTexImage3DEXT(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}}, 0, \mbox{\hyperlink{glad_8h_a9f2854f4a91a0d83d2d54cb8110bfca4}{GL\_RGBA}},}
\DoxyCodeLine{463                       1,1,64,}
\DoxyCodeLine{464                       0,\mbox{\hyperlink{glad_8h_a9f2854f4a91a0d83d2d54cb8110bfca4}{GL\_RGBA}},\mbox{\hyperlink{glad_8h_a80a33c79f69417372d65d2a65ca36d49}{GL\_UNSIGNED\_BYTE}},\mbox{\hyperlink{include_2vally_2config_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}});}
\DoxyCodeLine{465    \mbox{\hyperlink{cave__render_8c_a5a5da02ffa962221a8ddf7318d07a30b}{init\_tex2\_gradient}}();}
\DoxyCodeLine{466    \mbox{\hyperlink{cave__render_8c_a780d126fbb25c976ce349b06059ecc66}{set\_tex2\_alpha}}(0.0);}
\DoxyCodeLine{467 \textcolor{preprocessor}{   \#if 0}}
\DoxyCodeLine{468    \textcolor{keywordflow}{for} (i=0; i < 128; ++i) \{}
\DoxyCodeLine{469       \textcolor{comment}{//build\_overlay\_texture(i);}}
\DoxyCodeLine{470       glTexSubImage3DEXT(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}}, 0, 0,0,i, \mbox{\hyperlink{cave__render_8c_a56dce54d2eef141faab9d338d77e9902}{TEX\_SIZE}},\mbox{\hyperlink{cave__render_8c_a56dce54d2eef141faab9d338d77e9902}{TEX\_SIZE}},1, \mbox{\hyperlink{glad_8h_a9f2854f4a91a0d83d2d54cb8110bfca4}{GL\_RGBA}}, \mbox{\hyperlink{glad_8h_a80a33c79f69417372d65d2a65ca36d49}{GL\_UNSIGNED\_BYTE}}, \mbox{\hyperlink{structtexture}{texture}}[0]);}
\DoxyCodeLine{471    \}}
\DoxyCodeLine{472 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{473    \mbox{\hyperlink{glad_8h_a5817fa85137822142b4951eacd0154e7}{glTexParameteri}}(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}}, \mbox{\hyperlink{glad_8h_a173a2b2453322dd8d613df6cf2e72480}{GL\_TEXTURE\_MIN\_FILTER}}, \mbox{\hyperlink{glad_8h_a724edc4d9d6f3c1770ff3688f0747acb}{GL\_LINEAR\_MIPMAP\_LINEAR}});}
\DoxyCodeLine{474    \mbox{\hyperlink{glad_8h_a5817fa85137822142b4951eacd0154e7}{glTexParameteri}}(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}}, \mbox{\hyperlink{glad_8h_acb47a41b5963d44826f44b7370bccc26}{GL\_TEXTURE\_MAG\_FILTER}}, \mbox{\hyperlink{glad_8h_a4e682f218130b98b27a1e33fa7325080}{GL\_LINEAR}});}
\DoxyCodeLine{475    glGenerateMipmapEXT(\mbox{\hyperlink{glext_8h_a3d1b579f3fdbc2b4789bb447114c5119}{GL\_TEXTURE\_2D\_ARRAY\_EXT}});}
\DoxyCodeLine{476 \}}

\end{DoxyCode}
\mbox{\Hypertarget{caveview_8h_af74c70130c88949f4d2bac551594d41f}\label{caveview_8h_af74c70130c88949f4d2bac551594d41f}} 
\index{caveview.h@{caveview.h}!reset\_cache\_size@{reset\_cache\_size}}
\index{reset\_cache\_size@{reset\_cache\_size}!caveview.h@{caveview.h}}
\doxysubsubsection{\texorpdfstring{reset\_cache\_size()}{reset\_cache\_size()}}
{\footnotesize\ttfamily \mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} reset\+\_\+cache\+\_\+size (\begin{DoxyParamCaption}\item[{int}]{size }\end{DoxyParamCaption})}



Definition at line 490 of file cave\+\_\+mesher.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{491 \{}
\DoxyCodeLine{492    \textcolor{keywordtype}{int} i,j;}
\DoxyCodeLine{493    \textcolor{keywordflow}{for} (j=\mbox{\hyperlink{glad_8h_a3d1e3edfcf61ca2d831883e1afbad89e}{size}}; j < \mbox{\hyperlink{cave__mesher_8c_adc2cfac3a357c5424aafa9d351a2e6ea}{cache\_size}}; ++j) \{}
\DoxyCodeLine{494       \textcolor{keywordflow}{for} (i=\mbox{\hyperlink{glad_8h_a3d1e3edfcf61ca2d831883e1afbad89e}{size}}; i < \mbox{\hyperlink{cave__mesher_8c_adc2cfac3a357c5424aafa9d351a2e6ea}{cache\_size}}; ++i) \{}
\DoxyCodeLine{495          \mbox{\hyperlink{structcached__converted__chunk}{cached\_converted\_chunk}} *ccc = \&\mbox{\hyperlink{cave__mesher_8c_ab799c6e56a65a1a9a2c089c9d4b81de9}{chunk\_cache}}[j][i];}
\DoxyCodeLine{496          \textcolor{keywordflow}{if} (ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_a890fc62a8689a97e24ffd59097770836}{valid}}) \{}
\DoxyCodeLine{497             \textcolor{keywordflow}{if} (ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_ad891f426a0caf16bf5a9a54439beeade}{fc}}) \{}
\DoxyCodeLine{498                \mbox{\hyperlink{stb__leakcheck_8h_a9d4b5df3530d1bc733070a4669ba6ebc}{free}}(ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_ad891f426a0caf16bf5a9a54439beeade}{fc}}-\/>\mbox{\hyperlink{structfast__chunk_aea03b39185c1d472a7f61f86529f0863}{pointer\_to\_free}});}
\DoxyCodeLine{499                \mbox{\hyperlink{stb__leakcheck_8h_a9d4b5df3530d1bc733070a4669ba6ebc}{free}}(ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_ad891f426a0caf16bf5a9a54439beeade}{fc}});}
\DoxyCodeLine{500                ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_ad891f426a0caf16bf5a9a54439beeade}{fc}} = \mbox{\hyperlink{include_2vally_2config_8h_a070d2ce7b6bb7e5c05602aa8c308d0c4}{NULL}};}
\DoxyCodeLine{501             \}}
\DoxyCodeLine{502             ccc-\/>\mbox{\hyperlink{structcached__converted__chunk_a890fc62a8689a97e24ffd59097770836}{valid}} = 0;}
\DoxyCodeLine{503          \}}
\DoxyCodeLine{504       \}}
\DoxyCodeLine{505    \}}
\DoxyCodeLine{506    \mbox{\hyperlink{cave__mesher_8c_adc2cfac3a357c5424aafa9d351a2e6ea}{cache\_size}} = \mbox{\hyperlink{glad_8h_a3d1e3edfcf61ca2d831883e1afbad89e}{size}};}
\DoxyCodeLine{507 \}}

\end{DoxyCode}
\mbox{\Hypertarget{caveview_8h_a5a106573dea6ac6f71be5e80fb56eefc}\label{caveview_8h_a5a106573dea6ac6f71be5e80fb56eefc}} 
\index{caveview.h@{caveview.h}!world\_init@{world\_init}}
\index{world\_init@{world\_init}!caveview.h@{caveview.h}}
\doxysubsubsection{\texorpdfstring{world\_init()}{world\_init()}}
{\footnotesize\ttfamily \mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}} world\+\_\+init (\begin{DoxyParamCaption}\item[{\mbox{\hyperlink{glext_8h_a46df6112013cf583e82b25cebd5cb499}{void}}}]{ }\end{DoxyParamCaption})}



Definition at line 478 of file cave\+\_\+render.\+c.


\begin{DoxyCode}{0}
\DoxyCodeLine{479 \{}
\DoxyCodeLine{480    \textcolor{keywordtype}{int} \mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}},\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}},\mbox{\hyperlink{glad_8h_a1af10666aa42292f407f6acc2af11948}{x}},\mbox{\hyperlink{glad_8h_af2e2675ea2e0b9a7ec6a98fcb44a938a}{y}};}
\DoxyCodeLine{481 }
\DoxyCodeLine{482    Uint64 start\_time, end\_time;}
\DoxyCodeLine{483 \textcolor{preprocessor}{   \#ifdef NDEBUG}}
\DoxyCodeLine{484    \textcolor{keywordtype}{int} \mbox{\hyperlink{glad_8h_a73b00379db2c7ac5e30a3aa2954a50ee}{range}} = 32;}
\DoxyCodeLine{485 \textcolor{preprocessor}{   \#else}}
\DoxyCodeLine{486    \textcolor{keywordtype}{int} \mbox{\hyperlink{glad_8h_a73b00379db2c7ac5e30a3aa2954a50ee}{range}} = 12;}
\DoxyCodeLine{487 \textcolor{preprocessor}{   \#endif}}
\DoxyCodeLine{488 }
\DoxyCodeLine{489    start\_time = SDL\_GetPerformanceCounter();}
\DoxyCodeLine{490 }
\DoxyCodeLine{491    \textcolor{comment}{// iterate in 8x8 clusters of qchunks at a time to get better converted-\/chunk-\/cache reuse}}
\DoxyCodeLine{492    \textcolor{comment}{// than a purely row-\/by-\/row ordering is (single-\/threaded this is a bigger win than}}
\DoxyCodeLine{493    \textcolor{comment}{// any of the above optimizations were, since it halves zlib/mc-\/conversion costs)}}
\DoxyCodeLine{494    \textcolor{keywordflow}{for} (\mbox{\hyperlink{glad_8h_a1af10666aa42292f407f6acc2af11948}{x}}=-\/\mbox{\hyperlink{glad_8h_a73b00379db2c7ac5e30a3aa2954a50ee}{range}}; \mbox{\hyperlink{glad_8h_a1af10666aa42292f407f6acc2af11948}{x}} <= \mbox{\hyperlink{glad_8h_a73b00379db2c7ac5e30a3aa2954a50ee}{range}}; \mbox{\hyperlink{glad_8h_a1af10666aa42292f407f6acc2af11948}{x}} += 16)}
\DoxyCodeLine{495       \textcolor{keywordflow}{for} (\mbox{\hyperlink{glad_8h_af2e2675ea2e0b9a7ec6a98fcb44a938a}{y}}=-\/\mbox{\hyperlink{glad_8h_a73b00379db2c7ac5e30a3aa2954a50ee}{range}}; \mbox{\hyperlink{glad_8h_af2e2675ea2e0b9a7ec6a98fcb44a938a}{y}} <= \mbox{\hyperlink{glad_8h_a73b00379db2c7ac5e30a3aa2954a50ee}{range}}; \mbox{\hyperlink{glad_8h_af2e2675ea2e0b9a7ec6a98fcb44a938a}{y}} += 16)}
\DoxyCodeLine{496          \textcolor{keywordflow}{for} (\mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}}=\mbox{\hyperlink{glad_8h_af2e2675ea2e0b9a7ec6a98fcb44a938a}{y}}; \mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}} < \mbox{\hyperlink{glad_8h_af2e2675ea2e0b9a7ec6a98fcb44a938a}{y}}+16 \&\& \mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}} <= \mbox{\hyperlink{glad_8h_a73b00379db2c7ac5e30a3aa2954a50ee}{range}}; \mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}} += 2)}
\DoxyCodeLine{497             \textcolor{keywordflow}{for} (\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}=\mbox{\hyperlink{glad_8h_a1af10666aa42292f407f6acc2af11948}{x}}; \mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}} < \mbox{\hyperlink{glad_8h_a1af10666aa42292f407f6acc2af11948}{x}}+16 \&\& \mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}} <= \mbox{\hyperlink{glad_8h_a73b00379db2c7ac5e30a3aa2954a50ee}{range}}; \mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}} += 2)}
\DoxyCodeLine{498                \textcolor{keywordflow}{while} (!\mbox{\hyperlink{cave__render_8c_a18386edf73cd3e3f424ea7cb0f5dab1e}{request\_chunk}}(\mbox{\hyperlink{glad_8h_a3309789fc188587d666cda5ece79cf82}{a}}, \mbox{\hyperlink{glad_8h_a0f71581a41fd2264c8944126dabbd010}{b}})) \{ \textcolor{comment}{// if request fails, all threads are busy}}
\DoxyCodeLine{499                   \mbox{\hyperlink{cave__render_8c_a654d2857d277992878a8c7ff1f740282}{update\_meshes\_from\_render\_thread}}();}
\DoxyCodeLine{500                   SDL\_Delay(1);}
\DoxyCodeLine{501                \}}
\DoxyCodeLine{502 }
\DoxyCodeLine{503    \textcolor{comment}{// wait until all the workers are done,}}
\DoxyCodeLine{504    \textcolor{comment}{// (this is only needed if we want to time}}
\DoxyCodeLine{505    \textcolor{comment}{// when the build finishes, or when we want to reset the}}
\DoxyCodeLine{506    \textcolor{comment}{// cache size; otherwise we could just go ahead and}}
\DoxyCodeLine{507    \textcolor{comment}{// start rendering whatever we've got)}}
\DoxyCodeLine{508    \textcolor{keywordflow}{for}(;;) \{}
\DoxyCodeLine{509       \textcolor{keywordtype}{int} i;}
\DoxyCodeLine{510       \mbox{\hyperlink{cave__render_8c_a654d2857d277992878a8c7ff1f740282}{update\_meshes\_from\_render\_thread}}();}
\DoxyCodeLine{511       \textcolor{keywordflow}{for} (i=0; i < \mbox{\hyperlink{cave__render_8c_a7cd3d17270efa49416663f4e571144cc}{num\_mesh\_workers}}; ++i)}
\DoxyCodeLine{512          \textcolor{keywordflow}{if} (\mbox{\hyperlink{cave__render_8c_a285a49a21e43d98e9f7ea0f052a733dc}{mesh\_data}}[i].state != \mbox{\hyperlink{cave__render_8c_ae33c78feb670de33d2abf21ec0624531af3fbd3dcee01d8d3f4a3b08150f8f159}{WSTATE\_idle}})}
\DoxyCodeLine{513             \textcolor{keywordflow}{break};}
\DoxyCodeLine{514       \textcolor{keywordflow}{if} (i == \mbox{\hyperlink{cave__render_8c_a7cd3d17270efa49416663f4e571144cc}{num\_mesh\_workers}})}
\DoxyCodeLine{515          \textcolor{keywordflow}{break};}
\DoxyCodeLine{516       SDL\_Delay(3);}
\DoxyCodeLine{517    \}}
\DoxyCodeLine{518 }
\DoxyCodeLine{519    end\_time = SDL\_GetPerformanceCounter();}
\DoxyCodeLine{520    \mbox{\hyperlink{cave__main_8c_aefd62d461236c6e9ced738eac9d8042c}{ods}}(\textcolor{stringliteral}{"Build time: \%7.2fs\(\backslash\)n"}, (end\_time -\/ start\_time) / (\textcolor{keywordtype}{float}) SDL\_GetPerformanceFrequency());}
\DoxyCodeLine{521 }
\DoxyCodeLine{522    \textcolor{comment}{// don't waste lots of storage on chunk caches once it's finished starting-\/up;}}
\DoxyCodeLine{523    \textcolor{comment}{// this was only needed to be this large because we worked in large blocks}}
\DoxyCodeLine{524    \textcolor{comment}{// to maximize sharing}}
\DoxyCodeLine{525    \mbox{\hyperlink{cave__mesher_8c_af74c70130c88949f4d2bac551594d41f}{reset\_cache\_size}}(32);}
\DoxyCodeLine{526 \}}

\end{DoxyCode}
